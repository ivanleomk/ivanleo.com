{
  "title": "Deriving the Derivative for a softmax cross entropy",
  "date": "2023-10-23T00:00:00.000Z",
  "description": "A simple walkthrough to deriving the derivative ( with code ) for the cross entropy loss",
  "categories": [
    "CS231n",
    "Mathematics",
    "Machine Learning"
  ],
  "draft": false,
  "body": {
    "raw": "\n## Introduction\n\nI recently spent some time working on Assignment 1 for CS231n and as part of it, we needed to manually calculate the derivative of the softmax cross entropy loss to update the weights of a two-layer neural network manually. This was a bit complicated and I struggled for a good 2-3 days before I managed to understand how all the parts fit together.\n\nLet's start by working through some key definitions. In order to understand everything, you'll need to have an understanding of the following few things\n\n1. The Chain Rule\n2. What is a Softmax and how can we calculate its derivative\n3. What is the cross-entropy loss\n4. How can we apply the chain rule to more complex derivatives\n\nOnce we've gotten a hang of all these concepts, we'll get to the juicy part - deriving the derivative of the softmax cross-entropy loss.\n\n> I assume you've got a rough understanding of derivatives. I try to give a basic understanding of how to derive the derivatives below but it'll make much more sense if you spent a few minutes looking through your old calculus notebook. :)\n\n## Chain Rule\n\nThe chain rule can be understood with the following equation.\n\n<BlockMath math=\"\\frac{dy}{dx} = \\frac{dy}{du} \\times \\frac{du}{dx}\" />\n\nLet's see a more concret example. Let's say that we have the following two equations.\n\n<BlockMath math=\"z = 2x + y\" />\n<BlockMath math=\"x = a - 3b\" />\n\nand we assume that we have the following values where <InlineMath math=\"a=10,b=1,y=3\" />. This means that we can in turn derive the following values.\n\n<BlockMath math=\"x = 10 - 3 \\times 1 = 7\" />\n<BlockMath math=\"z = 2\\times (7) + 3 = 17\" />\n\nThe chain rule would come in useful if we wanted to know how a change in the value of <InlineMath math = \"b\" /> might affect something like <InlineMath math = \"z\" />. We could of course inline a and b directly into the equation above in this simple example but you'll find that this might not always be the case for more complex examples.\n\nLet's first try to compute how <InlineMath math = \"z\" /> changes when we change the value of <InlineMath math = \"x\" />. Well, in our previous example, we had <InlineMath math = \"x=7\" />. What happens if we use <InlineMath math = \"x = 6\" /> and <InlineMath math = \"x = 8\" />?\n\nWell, we can calculate the new sums of what <InlineMath math = \"z\" /> would be assuming that <InlineMath math = \"y\" /> remains constant. In our case, we notice that when <InlineMath math = \"x = 6\" />, we get <InlineMath math = \"z = 15\" /> whereas when <InlineMath math = \"x = 7\" />, we get <InlineMath math = \"z = 17\" />. This means that effectively, everytime we modify the value of <InlineMath math = \"x\" /> by 1, we observe a corresponding change in the value of <InlineMath math = \"z\" /> of 2. We can write this more formally as\n\n<BlockMath math=\"\\frac{dz}{dx}=2\" />\n\nLet's apply a similar logic to find how the value of <InlineMath math = \"x\" /> changes when we modify <InlineMath math = \"b\" /> by 1. If we perform the same steps, we'll find that\n\n<BlockMath math=\"\\frac{dx}{db}=-3\" />\n\nWell, how can we then apply this to find the value of <InlineMath math = \"\\frac{dz}{db}\" />? Well, the chain rule tells us that\n\n<BlockMath math=\"\\frac{dz}{db}= \\frac{dz}{dx} \\times \\frac{dx}{db} = 2 \\times (-3) = -6\" />\n\nSo, with that we now know how to calculate derivatives for variables that are linked via a series of equations. Let's now move on to what the softmax is.\n\n## Softmax\n\n### What is the Softmax Function\n\nLet's imagine that we had three possible events - get a candy, get a toy or get a cake every time we go visit our grand parents. If we visit them 10 times and out of the 10 times, we have\n\n- 3 candies\n- 3 toys\n- 4 cakes\n\nWe could in turn represent the total distribution of events as\n\n```py\ncounts = [3,3,4]\n```\n\nBut we could convert this to a probability distribution by taking\n\n<BlockMath math=\"P(\\text{Get A Toy}) = \\frac{3}{3 + 3 + 4} = \\frac{3}{10}\" />\n\nThe Softmax Function works kind of similarly. It allows us to take any arbitrary numbers and then convert them to a purely positive range. This is because of how the expoential function <InlineMath math = \"e^x\" /> behaves. You can see this from the graph below.\n\n<img src=\"/images/exponential.jpeg\" alt=\"Softmax Function\" />\n\nBy normalising our inputs to the positive ranges, we've now obtained \"counts\" of our target variables. We can then normalise these counts, similiar to the example above to a vector of floats that we can treat as a probability distribution. This is done by applying the formula of\n\n<BlockMath math=\"S(x_i) = \\frac{e^{x_i}}{\\sum_{j=0}^n e^{x_j}}\" />\n\nIn fact, this is how we've chosen to interpret the result of most models, GPT models have a softmax layer at the end of their output layers which we then sample from to generate the next token. Using probability distributions also gives us more interesting results. ( _Note_ : in Anthropic's constituitional AI paper, they constrain the probability of generate outputs to ~40 - 60%. So we can see how we can take a raw probability distribution using the softmax and then modify it to generate a smaller distribution )\n\n### Numerical Instability\n\nHowever, we're representing our values in code as floating point numbers. These are finite representations which cannot represent infinite values. Therefore, we can get some funky behaviour once we get large numbers. But, this doesn't even happen when we reach super large numbers.\n\n```py\nx = [-10,-1,1000]\nnp.exp(x) / np.sum(np.exp(x))\n\n> <ipython-input-4-c0960e0e33eb>:2: RuntimeWarning: overflow encountered in exp\n  np.exp(x) / np.sum(np.exp(x))\n> <ipython-input-4-c0960e0e33eb>:2: RuntimeWarning: invalid value encountered in divide\n  np.exp(x) / np.sum(np.exp(x))\n> array([ 0.,  0., nan])\n```\n\nThis poses a problem. If our numbers are too large, how can we ensure we are able to get the same probability distribution without integer overflow. Well, it turns out since Softmax is a monotonically increasing function, we can do the following and still achieve the same distributions.\n\n> For a more complex walkthrough, here's an explanation by [Jay K Mody](https://jaykmody.com/blog/stable-softmax/). A detailed walkthrough of softmax numerical instability is out of scope for this article.\n\n```py\nx = [-10,-1,1000]\nx = x - np.max(x)\nnp.exp(x) / np.sum(np.exp(x))\n\n> This yields [0,0,1]\n```\n\nThis brings us to a numerically stable implementation of the softmax as seen below.\n\n```py\ndef softmax(x):\n    # assumes x is a vector\n    x = x - np.max(x)\n    return np.exp(x) / np.sum(np.exp(x))\n```\n\n### Calculating the Derivative\n\nNow, let's move on to figuring out what the derivative is. Specifically, given an input <InlineMath math = \"x_j\" /> we want to calculate it's impact on a final softmax output <InlineMath math = \"S_i\" /> where we have an input size of <InlineMath math = \"n\" />. Let's start by writing out our equation.\n\n<BlockMath math=\"S_i = \\frac{e^{x_i}}{\\sum_{k=0}^n e^{x_k}}\" />\n\nAnd we want to find\n\n<BlockMath math=\"\\frac{\\delta S_i}{\\delta x_j} = \\frac{1}{\\delta x_j} [ \\frac{e^{x_i}}{\\sum_{k=0}^n e^{x_k}} ]\" />\n\nLet's first do a quick substituition where <InlineMath math = \"u = e^{x_i}, v = e^{x_j} + \\sum_{k=0,k \\neq j} e^{x_k}\" />. (Note here that we've simply pulled out our <InlineMath math = \"e^{x_j}\" /> term out of our original summation.) This means we can rewrite our original equation now as\n\n<BlockMath math=\"S(x_i) = \\frac{u}{v}\" />\n\nWhich allows us to apply the quotient rule that states that\n\n<BlockMath math=\"\\frac{\\delta S(x_i)}{x_j} = \\frac{v\\frac{\\delta u}{\\delta x_j} - u\\frac{\\delta v}{ \\delta x_j}}{v^{2}}\" />\n\nwhich we can then rewrite as\n\n<BlockMath math=\"\\frac{\\delta S(x_i)}{x_j} = \\frac{(e^{x_j} + \\sum_{k=0,k \\neq j} e^{x_k}) \\frac{1}{\\delta x_j} [e^{x_i}] - e^{x_i} \\frac{1}{\\delta x_j} [e^{x_j} + \\sum_{k=0,k \\neq j} e^{x_k}] }{(e^{x_j} + \\sum_{k=0,k \\neq j} e^{x_k})^2}\" />\n\nBefore we walkthrough the answer, note the following\n\n- we're taking the derivative with respect to <InlineMath math = \"x_j\" />\n- if <InlineMath math = \"y = e^x\" />, then this means that <InlineMath math = \"\\frac{\\delta y}{ \\delta x} = e^x\" />\n- if <InlineMath math = \"y = e^{x_i}\" /> and we take the derivative with respect to <InlineMath math = \"x_j\" />, then this means that we can treat <InlineMath math = \"e^{x_i}\" /> as a constant, and <InlineMath math = \"\\frac{\\delta y}{\\delta x_j} = 0\" />\n\nLet's now apply this new form to solve the two cases.\n\n<b>\n  Case 1 : <InlineMath math=\"i \\neq j\" />\n</b>\n\nWith the points above, we can rewrite our derivative and simplify it as\n\n<BlockMath math=\"\\begin{equation} \\begin{split}  \\frac{\\delta S(x_i)}{x_j} &= \\frac{(e^{x_j} + \\sum_{k=0,k \\neq j} e^{x_k}) 0 - e^{x_i} (e^{x_j}) }{(\\sum_{k=0}^n e^{x_k})^2} \\\\ &= \\frac{-e^{x_i} (e^{x_j})}{(\\sum_{k=0}^n e^{x_k})^2} \\end{split} \\end{equation}\" />\n\nIf you're confused about why the huge term <InlineMath math = \"e^{x_j} + \\sum_{k=0,k \\neq j} e^{x_k}\" /> was simplified, consider the fact that there are no terms expressed in terms of <InlineMath math = \"x_j\" /> in that summation and that <InlineMath math = \"y = e^{x_j}\" /> implies that <InlineMath math = \"\\frac{\\delta y}{\\delta x_j} = e^{x_j}\" />. Now, our derivative looks a little scary but if we rewrite it a little bit, we get the following\n\n<BlockMath math=\"\\begin{equation} \\begin{split} \\frac{\\delta S(x_i)}{\\delta x_j} &= -\\frac{e^{x_i}}{\\sum_{k=0}^n e^{x_k}} \\times \\frac{e^{x_j}}{\\sum_{k=0}^n e^{x_k}} \\\\ &= -S(x_i) S(x_j)  \\end{split} \\end{equation}\" />\n\n<b>\n  Case 2 : <InlineMath math=\"i = j\" />\n</b>\n\nIn this case, we can rewrite our equation as\n\n<BlockMath math=\"\\frac{\\delta S(x_i)}{x_i} = \\frac{(e^{x_i} + \\sum_{k=0,k \\neq i}^n e^{x_k}) \\frac{1}{\\delta x_i} [e^{x_i}] - e^{x_i} \\frac{1}{\\delta x_i} [e^{x_i} + \\sum_{k=0,k \\neq j}^n e^{x_k}] }{(e^{x_i} + \\sum_{k=0,k \\neq i}^n e^{x_k})^2}\" />\n\nWhich is going to be simplified to\n\n<BlockMath math=\"\\begin{equation} \\begin{split} \\frac{\\delta S(x_i)}{x_i} &= \\frac{(e^{x_i} + \\sum_{k=0,k \\neq i} e^{x_k}) e^{x_i} - e^{x_i} ( e^{x_i} ) }{(\\sum_{k=0}^n e^{x_k})^2} \\\\ &= \\frac{e^{x_i} (\\sum_{k=0,k \\neq i} e^{x_k}) }{(\\sum_{k=0}^n e^{x_k})^2} \\\\ &= \\frac{e^{x_i} ((\\sum_{k=0}^n e^{x_k}) - e^{x_i}) }{(\\sum_{k=0}^n e^{x_k})^2} \\\\ &= S(x_i) ( 1 - S(x_i))  \\end{split} \\end{equation}\" />\n\nThis therefore means that we can express our derivative in these two cases\n\n<BlockMath\n  math=\"\\frac{\\delta S(x_i)}{x_j} = \\begin{cases}\n  S(x_i) ( 1 - S(x_i))  & i = j \\\\\n  -S(x_i) S(x_j) & i \\neq j\n\\end{cases}\"\n/>\n\n## Cross-Entropy Loss\n\nThe Cross Entropy loss is commonly used when we have a model that we want to train to be able to classify an input into a specific class or multiple classes. In this article and example, we'll be looking at the case whereby we're trying to classify an input into a specific class.\n\n### Loss Functions\n\nWhen we have a loss function, we can take a prediction <InlineMath math = \"x\" /> and compute how good it is w.r.t some ground truth. This means that the better the predictions, <b>the lower the loss</b>. Our goal in doing so is to create a single objective number that we can look to slowly minimise.\n\nConceptually, this is because minimising a loss function means driving it as close to 0. If we tried to create a loss that we could maximise instead, then we simply wouldn't be able to maximise it since it would span from <InlineMath math = \"0,\\infty\" />.\n\nSo this brings us to two simple characteristics of a loss function\n\n- It has to have a range between <InlineMath math = \"0,\\infty\" />. If not we would be minimising towards <InlineMath math = \"-\\infty\" />.\n- The better our predictions, the lower our loss should be\n\n### Softmax and the Loss\n\nWe can see that our softmax outputs a vector which contains probabilities. These will range from 0 to 1. In our case, since we are looking to make a correct prediction, ideally our probability for the correct class should be 1. When it's a bad prediction, it will be close to 0.\n\nIf we took the raw probability as the loss, then this would mean that the better our predictions, the higher our loss. That's where the Cross-Entropy Loss comes in. It has the formula of\n\n<BlockMath math=\"L = -\\sum_{i=0}^n t_i log(S(X_i))\" />\n\nwhere <InlineMath math = \"t_i\" /> represents the predicted label for the i-th class and <InlineMath math = \"y_i\" /> represents the predicted probability that our softmax produces for the specific class <InlineMath math = \"i\" />. Since a item either belongs or does not belong to a class, this means that <InlineMath math = \"t_i\" /> can only take on the values of <InlineMath math = \"0,1\" />. Since we're predicting for a single class, this also means that essentially have the following sum\n\n<BlockMath math=\"L = -(0 \\times log(S(X_0)) + 0 \\times log(S(X_1)) + \\dots + 1 \\times log(S(X_i)) )\" />\n\nWhich brings our loss to\n\n<BlockMath math=\"L = -log(S(x_i))\" />\n\nwhere <InlineMath math = \"i\" /> represents the index of the correct class. This derivative is simply to calculate and is just\n\n<BlockMath\n  math=\"\n  \\frac{\\delta L}{\\delta S(x_i)} = - \\frac{1}{S(x_i)} \n\"\n/>\n\n## Bringing It All Together\n\nWe've now found two equations. The first is the cross entropy loss with respect to a specific softmax value.\n\n<BlockMath\n  math=\"\n  \\frac{\\delta L}{\\delta S(x_i)} = - \\frac{1}{S(x_i)} \n\"\n/>\n\nThe second is the softmax value w.r.t its original inputs.\n\n<BlockMath\n  math=\"\\frac{\\delta S(x_i)}{x_j} = \\begin{cases}\n  S(x_i) ( 1 - S(x_i))  & i = j \\\\\n  -S(x_i) S(x_j) & i \\neq j\n\\end{cases}\"\n/>\n\nWe can simply apply the chain rule to get the derivative of the loss w.r.t the original inputs to the softmax.\n\n<b>\n  Case 1 : <InlineMath math=\"i \\neq j\" />\n</b>\n\n<BlockMath math=\"\\begin{equation}\\begin{split} \\frac{\\delta L}{\\delta x_j} &= \\frac{\\delta L}{\\delta S(x_i)} \\times \\frac{\\delta S(x_i)}{x_j} \\\\ &= -\\frac{1}{S(x_i)} \\times -S(x_i) S(x_j) \\\\ &= S(x_j) \\end{split}\\end{equation}\" />\n\n<b>\n  Case 2 : <InlineMath math=\"i = j\" />\n</b>\n\n<BlockMath math=\"\\begin{equation}\\begin{split} \\frac{\\delta L}{\\delta x_j} &= \\frac{\\delta L}{\\delta S(x_i)} \\times \\frac{\\delta S(x_i)}{x_j} \\\\ &= -\\frac{1}{S(x_i)} \\times S(x_i) ( 1 - S(x_i))  \\\\ &= S(x_i) - 1 \\end{split}\\end{equation}\" />\n\nWe can write this in a case form as\n\n<BlockMath\n  math=\"\\frac{\\delta L}{\\delta x_j} = \\begin{cases}\n  S(x_i)-1  & i = j \\\\\n  S(x_j) & i \\neq j\n\\end{cases}\"\n/>\n\nThis makes the derivative back propogation facile to implement in python as an if-else\n\n```py\nfor j in range(len(inputs)):\n  if j == y[i]:\n      dW[:,j] += (-1 + softmax_output)\n  else:\n      dW[:,j] += softmax_output\n```\n",
    "code": "var Component=(()=>{var rn=Object.create;var R=Object.defineProperty;var un=Object.getOwnPropertyDescriptor;var cn=Object.getOwnPropertyNames;var bn=Object.getPrototypeOf,fn=Object.prototype.hasOwnProperty;var B=(u,n)=>()=>(n||u((n={exports:{}}).exports,n),n.exports),_n=(u,n)=>{for(var l in n)R(u,l,{get:n[l],enumerable:!0})},ve=(u,n,l,s)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let y of cn(n))!fn.call(u,y)&&y!==l&&R(u,y,{get:()=>n[y],enumerable:!(s=un(n,y))||s.enumerable});return u};var pn=(u,n,l)=>(l=u!=null?rn(bn(u)):{},ve(n||!u||!u.__esModule?R(l,\"default\",{value:u,enumerable:!0}):l,u)),Nn=u=>ve(R({},\"__esModule\",{value:!0}),u);var Ee=B((En,De)=>{De.exports=React});var Ue=B(X=>{\"use strict\";(function(){\"use strict\";var u=Ee(),n=Symbol.for(\"react.element\"),l=Symbol.for(\"react.portal\"),s=Symbol.for(\"react.fragment\"),y=Symbol.for(\"react.strict_mode\"),G=Symbol.for(\"react.profiler\"),H=Symbol.for(\"react.provider\"),K=Symbol.for(\"react.context\"),w=Symbol.for(\"react.forward_ref\"),O=Symbol.for(\"react.suspense\"),P=Symbol.for(\"react.suspense_list\"),A=Symbol.for(\"react.memo\"),W=Symbol.for(\"react.lazy\"),Ce=Symbol.for(\"react.offscreen\"),J=Symbol.iterator,ke=\"@@iterator\";function je(a){if(a===null||typeof a!=\"object\")return null;var d=J&&a[J]||a[ke];return typeof d==\"function\"?d:null}var D=u.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function _(a){{for(var d=arguments.length,i=new Array(d>1?d-1:0),m=1;m<d;m++)i[m-1]=arguments[m];Se(\"error\",a,i)}}function Se(a,d,i){{var m=D.ReactDebugCurrentFrame,r=m.getStackAddendum();r!==\"\"&&(d+=\"%s\",i=i.concat([r]));var c=i.map(function(t){return String(t)});c.unshift(\"Warning: \"+d),Function.prototype.apply.call(console[a],console,c)}}var Te=!1,Re=!1,Oe=!1,Pe=!1,We=!1,Z;Z=Symbol.for(\"react.module.reference\");function Ie(a){return!!(typeof a==\"string\"||typeof a==\"function\"||a===s||a===G||We||a===y||a===O||a===P||Pe||a===Ce||Te||Re||Oe||typeof a==\"object\"&&a!==null&&(a.$$typeof===W||a.$$typeof===A||a.$$typeof===H||a.$$typeof===K||a.$$typeof===w||a.$$typeof===Z||a.getModuleId!==void 0))}function Le(a,d,i){var m=a.displayName;if(m)return m;var r=d.displayName||d.name||\"\";return r!==\"\"?i+\"(\"+r+\")\":i}function Q(a){return a.displayName||\"Context\"}function h(a){if(a==null)return null;if(typeof a.tag==\"number\"&&_(\"Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue.\"),typeof a==\"function\")return a.displayName||a.name||null;if(typeof a==\"string\")return a;switch(a){case s:return\"Fragment\";case l:return\"Portal\";case G:return\"Profiler\";case y:return\"StrictMode\";case O:return\"Suspense\";case P:return\"SuspenseList\"}if(typeof a==\"object\")switch(a.$$typeof){case K:var d=a;return Q(d)+\".Consumer\";case H:var i=a;return Q(i._context)+\".Provider\";case w:return Le(a,a.render,\"ForwardRef\");case A:var m=a.displayName||null;return m!==null?m:h(a.type)||\"Memo\";case W:{var r=a,c=r._payload,t=r._init;try{return h(t(c))}catch{return null}}}return null}var v=Object.assign,F=0,ee,ne,ae,de,ie,se,me;function le(){}le.__reactDisabledLog=!0;function qe(){{if(F===0){ee=console.log,ne=console.info,ae=console.warn,de=console.error,ie=console.group,se=console.groupCollapsed,me=console.groupEnd;var a={configurable:!0,enumerable:!0,value:le,writable:!0};Object.defineProperties(console,{info:a,log:a,warn:a,error:a,group:a,groupCollapsed:a,groupEnd:a})}F++}}function Me(){{if(F--,F===0){var a={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:v({},a,{value:ee}),info:v({},a,{value:ne}),warn:v({},a,{value:ae}),error:v({},a,{value:de}),group:v({},a,{value:ie}),groupCollapsed:v({},a,{value:se}),groupEnd:v({},a,{value:me})})}F<0&&_(\"disabledDepth fell below zero. This is a bug in React. Please file an issue.\")}}var I=D.ReactCurrentDispatcher,L;function C(a,d,i){{if(L===void 0)try{throw Error()}catch(r){var m=r.stack.trim().match(/\\n( *(at )?)/);L=m&&m[1]||\"\"}return`\n`+L+a}}var q=!1,k;{var Ye=typeof WeakMap==\"function\"?WeakMap:Map;k=new Ye}function oe(a,d){if(!a||q)return\"\";{var i=k.get(a);if(i!==void 0)return i}var m;q=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var c;c=I.current,I.current=null,qe();try{if(d){var t=function(){throw Error()};if(Object.defineProperty(t.prototype,\"props\",{set:function(){throw Error()}}),typeof Reflect==\"object\"&&Reflect.construct){try{Reflect.construct(t,[])}catch(x){m=x}Reflect.construct(a,[],t)}else{try{t.call()}catch(x){m=x}a.call(t.prototype)}}else{try{throw Error()}catch(x){m=x}a()}}catch(x){if(x&&m&&typeof x.stack==\"string\"){for(var o=x.stack.split(`\n`),p=m.stack.split(`\n`),b=o.length-1,f=p.length-1;b>=1&&f>=0&&o[b]!==p[f];)f--;for(;b>=1&&f>=0;b--,f--)if(o[b]!==p[f]){if(b!==1||f!==1)do if(b--,f--,f<0||o[b]!==p[f]){var N=`\n`+o[b].replace(\" at new \",\" at \");return a.displayName&&N.includes(\"<anonymous>\")&&(N=N.replace(\"<anonymous>\",a.displayName)),typeof a==\"function\"&&k.set(a,N),N}while(b>=1&&f>=0);break}}}finally{q=!1,I.current=c,Me(),Error.prepareStackTrace=r}var U=a?a.displayName||a.name:\"\",ye=U?C(U):\"\";return typeof a==\"function\"&&k.set(a,ye),ye}function $e(a,d,i){return oe(a,!1)}function Ve(a){var d=a.prototype;return!!(d&&d.isReactComponent)}function j(a,d,i){if(a==null)return\"\";if(typeof a==\"function\")return oe(a,Ve(a));if(typeof a==\"string\")return C(a);switch(a){case O:return C(\"Suspense\");case P:return C(\"SuspenseList\")}if(typeof a==\"object\")switch(a.$$typeof){case w:return $e(a.render);case A:return j(a.type,d,i);case W:{var m=a,r=m._payload,c=m._init;try{return j(c(r),d,i)}catch{}}}return\"\"}var S=Object.prototype.hasOwnProperty,te={},re=D.ReactDebugCurrentFrame;function T(a){if(a){var d=a._owner,i=j(a.type,a._source,d?d.type:null);re.setExtraStackFrame(i)}else re.setExtraStackFrame(null)}function ze(a,d,i,m,r){{var c=Function.call.bind(S);for(var t in a)if(c(a,t)){var o=void 0;try{if(typeof a[t]!=\"function\"){var p=Error((m||\"React class\")+\": \"+i+\" type `\"+t+\"` is invalid; it must be a function, usually from the `prop-types` package, but received `\"+typeof a[t]+\"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.\");throw p.name=\"Invariant Violation\",p}o=a[t](d,t,m,i,null,\"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED\")}catch(b){o=b}o&&!(o instanceof Error)&&(T(r),_(\"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).\",m||\"React class\",i,t,typeof o),T(null)),o instanceof Error&&!(o.message in te)&&(te[o.message]=!0,T(r),_(\"Failed %s type: %s\",i,o.message),T(null))}}}var Be=Array.isArray;function M(a){return Be(a)}function Xe(a){{var d=typeof Symbol==\"function\"&&Symbol.toStringTag,i=d&&a[Symbol.toStringTag]||a.constructor.name||\"Object\";return i}}function Ge(a){try{return ue(a),!1}catch{return!0}}function ue(a){return\"\"+a}function ce(a){if(Ge(a))return _(\"The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.\",Xe(a)),ue(a)}var g=D.ReactCurrentOwner,He={key:!0,ref:!0,__self:!0,__source:!0},be,fe,Y;Y={};function Ke(a){if(S.call(a,\"ref\")){var d=Object.getOwnPropertyDescriptor(a,\"ref\").get;if(d&&d.isReactWarning)return!1}return a.ref!==void 0}function Je(a){if(S.call(a,\"key\")){var d=Object.getOwnPropertyDescriptor(a,\"key\").get;if(d&&d.isReactWarning)return!1}return a.key!==void 0}function Ze(a,d){if(typeof a.ref==\"string\"&&g.current&&d&&g.current.stateNode!==d){var i=h(g.current.type);Y[i]||(_('Component \"%s\" contains the string ref \"%s\". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',h(g.current.type),a.ref),Y[i]=!0)}}function Qe(a,d){{var i=function(){be||(be=!0,_(\"%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",d))};i.isReactWarning=!0,Object.defineProperty(a,\"key\",{get:i,configurable:!0})}}function en(a,d){{var i=function(){fe||(fe=!0,_(\"%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",d))};i.isReactWarning=!0,Object.defineProperty(a,\"ref\",{get:i,configurable:!0})}}var nn=function(a,d,i,m,r,c,t){var o={$$typeof:n,type:a,key:d,ref:i,props:t,_owner:c};return o._store={},Object.defineProperty(o._store,\"validated\",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(o,\"_self\",{configurable:!1,enumerable:!1,writable:!1,value:m}),Object.defineProperty(o,\"_source\",{configurable:!1,enumerable:!1,writable:!1,value:r}),Object.freeze&&(Object.freeze(o.props),Object.freeze(o)),o};function an(a,d,i,m,r){{var c,t={},o=null,p=null;i!==void 0&&(ce(i),o=\"\"+i),Je(d)&&(ce(d.key),o=\"\"+d.key),Ke(d)&&(p=d.ref,Ze(d,r));for(c in d)S.call(d,c)&&!He.hasOwnProperty(c)&&(t[c]=d[c]);if(a&&a.defaultProps){var b=a.defaultProps;for(c in b)t[c]===void 0&&(t[c]=b[c])}if(o||p){var f=typeof a==\"function\"?a.displayName||a.name||\"Unknown\":a;o&&Qe(t,f),p&&en(t,f)}return nn(a,o,p,r,m,g.current,t)}}var $=D.ReactCurrentOwner,_e=D.ReactDebugCurrentFrame;function E(a){if(a){var d=a._owner,i=j(a.type,a._source,d?d.type:null);_e.setExtraStackFrame(i)}else _e.setExtraStackFrame(null)}var V;V=!1;function z(a){return typeof a==\"object\"&&a!==null&&a.$$typeof===n}function pe(){{if($.current){var a=h($.current.type);if(a)return`\n\nCheck the render method of \\``+a+\"`.\"}return\"\"}}function dn(a){{if(a!==void 0){var d=a.fileName.replace(/^.*[\\\\\\/]/,\"\"),i=a.lineNumber;return`\n\nCheck your code at `+d+\":\"+i+\".\"}return\"\"}}var Ne={};function sn(a){{var d=pe();if(!d){var i=typeof a==\"string\"?a:a.displayName||a.name;i&&(d=`\n\nCheck the top-level render call using <`+i+\">.\")}return d}}function he(a,d){{if(!a._store||a._store.validated||a.key!=null)return;a._store.validated=!0;var i=sn(d);if(Ne[i])return;Ne[i]=!0;var m=\"\";a&&a._owner&&a._owner!==$.current&&(m=\" It was passed a child from \"+h(a._owner.type)+\".\"),E(a),_('Each child in a list should have a unique \"key\" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',i,m),E(null)}}function xe(a,d){{if(typeof a!=\"object\")return;if(M(a))for(var i=0;i<a.length;i++){var m=a[i];z(m)&&he(m,d)}else if(z(a))a._store&&(a._store.validated=!0);else if(a){var r=je(a);if(typeof r==\"function\"&&r!==a.entries)for(var c=r.call(a),t;!(t=c.next()).done;)z(t.value)&&he(t.value,d)}}}function mn(a){{var d=a.type;if(d==null||typeof d==\"string\")return;var i;if(typeof d==\"function\")i=d.propTypes;else if(typeof d==\"object\"&&(d.$$typeof===w||d.$$typeof===A))i=d.propTypes;else return;if(i){var m=h(d);ze(i,a.props,\"prop\",m,a)}else if(d.PropTypes!==void 0&&!V){V=!0;var r=h(d);_(\"Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?\",r||\"Unknown\")}typeof d.getDefaultProps==\"function\"&&!d.getDefaultProps.isReactClassApproved&&_(\"getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.\")}}function ln(a){{for(var d=Object.keys(a.props),i=0;i<d.length;i++){var m=d[i];if(m!==\"children\"&&m!==\"key\"){E(a),_(\"Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.\",m),E(null);break}}a.ref!==null&&(E(a),_(\"Invalid attribute `ref` supplied to `React.Fragment`.\"),E(null))}}function on(a,d,i,m,r,c){{var t=Ie(a);if(!t){var o=\"\";(a===void 0||typeof a==\"object\"&&a!==null&&Object.keys(a).length===0)&&(o+=\" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.\");var p=dn(r);p?o+=p:o+=pe();var b;a===null?b=\"null\":M(a)?b=\"array\":a!==void 0&&a.$$typeof===n?(b=\"<\"+(h(a.type)||\"Unknown\")+\" />\",o=\" Did you accidentally export a JSX literal instead of a component?\"):b=typeof a,_(\"React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s\",b,o)}var f=an(a,d,i,r,c);if(f==null)return f;if(t){var N=d.children;if(N!==void 0)if(m)if(M(N)){for(var U=0;U<N.length;U++)xe(N[U],a);Object.freeze&&Object.freeze(N)}else _(\"React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.\");else xe(N,a)}return a===s?ln(f):mn(f),f}}var tn=on;X.Fragment=s,X.jsxDEV=tn})()});var ge=B((Fn,Fe)=>{\"use strict\";Fe.exports=Ue()});var vn={};_n(vn,{default:()=>yn,frontmatter:()=>hn});var e=pn(ge()),hn={title:\"Deriving the Derivative for a softmax cross entropy\",date:new Date(16980192e5),categories:[\"CS231n\",\"Mathematics\",\"Machine Learning\"],description:\"A simple walkthrough to deriving the derivative ( with code ) for the cross entropy loss\"};function we(u){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",ol:\"ol\",li:\"li\",blockquote:\"blockquote\",h3:\"h3\",ul:\"ul\",div:\"div\",pre:\"pre\",code:\"code\",em:\"em\"},u.components),{BlockMath:l,InlineMath:s}=n;return l||Ae(\"BlockMath\",!0,\"30:1-30:72\"),s||Ae(\"InlineMath\",!0,\"37:55-37:89\"),(0,e.jsxDEV)(e.Fragment,{children:[(0,e.jsxDEV)(n.h2,{id:\"introduction\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#introduction\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this),\"Introduction\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:11,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"I recently spent some time working on Assignment 1 for CS231n and as part of it, we needed to manually calculate the derivative of the softmax cross entropy loss to update the weights of a two-layer neural network manually. This was a bit complicated and I struggled for a good 2-3 days before I managed to understand how all the parts fit together.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:13,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Let's start by working through some key definitions. In order to understand everything, you'll need to have an understanding of the following few things\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:15,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.ol,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:\"The Chain Rule\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:17,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:\"What is a Softmax and how can we calculate its derivative\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:18,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:\"What is the cross-entropy loss\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:19,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:\"How can we apply the chain rule to more complex derivatives\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:20,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:17,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Once we've gotten a hang of all these concepts, we'll get to the juicy part - deriving the derivative of the softmax cross-entropy loss.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:22,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.blockquote,{children:[`\n`,(0,e.jsxDEV)(n.p,{children:\"I assume you've got a rough understanding of derivatives. I try to give a basic understanding of how to derive the derivatives below but it'll make much more sense if you spent a few minutes looking through your old calculus notebook. :)\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:24,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:24,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h2,{id:\"chain-rule\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#chain-rule\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this),\"Chain Rule\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:26,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"The chain rule can be understood with the following equation.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:28,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"\\\\frac{dy}{dx} = \\\\frac{dy}{du} \\\\times \\\\frac{du}{dx}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:30,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Let's see a more concret example. Let's say that we have the following two equations.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:32,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"z = 2x + y\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:34,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"x = a - 3b\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:35,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"and we assume that we have the following values where \",(0,e.jsxDEV)(s,{math:\"a=10,b=1,y=3\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:37,columnNumber:55},this),\". This means that we can in turn derive the following values.\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:37,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"x = 10 - 3 \\\\times 1 = 7\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:39,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"z = 2\\\\times (7) + 3 = 17\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:40,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"The chain rule would come in useful if we wanted to know how a change in the value of \",(0,e.jsxDEV)(s,{math:\"b\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:42,columnNumber:87},this),\" might affect something like \",(0,e.jsxDEV)(s,{math:\"z\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:42,columnNumber:141},this),\". We could of course inline a and b directly into the equation above in this simple example but you'll find that this might not always be the case for more complex examples.\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:42,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"Let's first try to compute how \",(0,e.jsxDEV)(s,{math:\"z\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:44,columnNumber:32},this),\" changes when we change the value of \",(0,e.jsxDEV)(s,{math:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:44,columnNumber:94},this),\". Well, in our previous example, we had \",(0,e.jsxDEV)(s,{math:\"x=7\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:44,columnNumber:159},this),\". What happens if we use \",(0,e.jsxDEV)(s,{math:\"x = 6\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:44,columnNumber:211},this),\" and \",(0,e.jsxDEV)(s,{math:\"x = 8\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:44,columnNumber:245},this),\"?\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:44,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"Well, we can calculate the new sums of what \",(0,e.jsxDEV)(s,{math:\"z\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:46,columnNumber:45},this),\" would be assuming that \",(0,e.jsxDEV)(s,{math:\"y\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:46,columnNumber:94},this),\" remains constant. In our case, we notice that when \",(0,e.jsxDEV)(s,{math:\"x = 6\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:46,columnNumber:171},this),\", we get \",(0,e.jsxDEV)(s,{math:\"z = 15\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:46,columnNumber:209},this),\" whereas when \",(0,e.jsxDEV)(s,{math:\"x = 7\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:46,columnNumber:253},this),\", we get \",(0,e.jsxDEV)(s,{math:\"z = 17\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:46,columnNumber:291},this),\". This means that effectively, everytime we modify the value of \",(0,e.jsxDEV)(s,{math:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:46,columnNumber:385},this),\" by 1, we observe a corresponding change in the value of \",(0,e.jsxDEV)(s,{math:\"z\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:46,columnNumber:467},this),\" of 2. We can write this more formally as\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:46,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"\\\\frac{dz}{dx}=2\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:48,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"Let's apply a similar logic to find how the value of \",(0,e.jsxDEV)(s,{math:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:50,columnNumber:54},this),\" changes when we modify \",(0,e.jsxDEV)(s,{math:\"b\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:50,columnNumber:103},this),\" by 1. If we perform the same steps, we'll find that\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:50,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"\\\\frac{dx}{db}=-3\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:52,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"Well, how can we then apply this to find the value of \",(0,e.jsxDEV)(s,{math:\"\\\\frac{dz}{db}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:54,columnNumber:55},this),\"? Well, the chain rule tells us that\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:54,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"\\\\frac{dz}{db}= \\\\frac{dz}{dx} \\\\times \\\\frac{dx}{db} = 2 \\\\times (-3) = -6\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:56,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"So, with that we now know how to calculate derivatives for variables that are linked via a series of equations. Let's now move on to what the softmax is.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:58,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h2,{id:\"softmax\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#softmax\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this),\"Softmax\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:60,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h3,{id:\"what-is-the-softmax-function\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#what-is-the-softmax-function\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this),\"What is the Softmax Function\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:62,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Let's imagine that we had three possible events - get a candy, get a toy or get a cake every time we go visit our grand parents. If we visit them 10 times and out of the 10 times, we have\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:64,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.ul,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:\"3 candies\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:66,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:\"3 toys\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:67,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:\"4 cakes\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:68,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:66,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"We could in turn represent the total distribution of events as\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:70,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,e.jsxDEV)(n.pre,{\"data-language\":\"py\",\"data-theme\":\"default\",children:(0,e.jsxDEV)(n.code,{\"data-language\":\"py\",\"data-theme\":\"default\",children:(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"counts \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:109},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:152},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:189},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"[\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:226},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"3\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:263},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:300},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"3\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:337},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:374},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"4\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:411},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"]\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:448},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:90},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:84},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:72,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"But we could convert this to a probability distribution by taking\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:76,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"P(\\\\text{Get A Toy}) = \\\\frac{3}{3 + 3 + 4} = \\\\frac{3}{10}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:78,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"The Softmax Function works kind of similarly. It allows us to take any arbitrary numbers and then convert them to a purely positive range. This is because of how the expoential function \",(0,e.jsxDEV)(s,{math:\"e^x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:80,columnNumber:187},this),\" behaves. You can see this from the graph below.\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:80,columnNumber:1},this),`\n`,(0,e.jsxDEV)(\"img\",{src:\"/images/exponential.jpeg\",alt:\"Softmax Function\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:82,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:`By normalising our inputs to the positive ranges, we've now obtained \"counts\" of our target variables. We can then normalise these counts, similiar to the example above to a vector of floats that we can treat as a probability distribution. This is done by applying the formula of`},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:84,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"S(x_i) = \\\\frac{e^{x_i}}{\\\\sum_{j=0}^n e^{x_j}}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:86,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"In fact, this is how we've chosen to interpret the result of most models, GPT models have a softmax layer at the end of their output layers which we then sample from to generate the next token. Using probability distributions also gives us more interesting results. ( \",(0,e.jsxDEV)(n.em,{children:\"Note\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:88,columnNumber:269},this),\" : in Anthropic's constituitional AI paper, they constrain the probability of generate outputs to ~40 - 60%. So we can see how we can take a raw probability distribution using the softmax and then modify it to generate a smaller distribution )\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:88,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h3,{id:\"numerical-instability\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#numerical-instability\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this),\"Numerical Instability\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:90,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"However, we're representing our values in code as floating point numbers. These are finite representations which cannot represent infinite values. Therefore, we can get some funky behaviour once we get large numbers. But, this doesn't even happen when we reach super large numbers.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:92,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,e.jsxDEV)(n.pre,{\"data-language\":\"py\",\"data-theme\":\"default\",children:(0,e.jsxDEV)(n.code,{\"data-language\":\"py\",\"data-theme\":\"default\",children:[(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"x \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:109},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:147},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:184},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"[\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:221},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:258},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"10\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:295},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:333},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:370},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"1\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:407},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:444},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"1000\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:481},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"]\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:521},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:90},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"np\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:58},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:95},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:134},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:171},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:208},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:245},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"/\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:282},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" np\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:319},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:358},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"sum\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:395},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:434},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"np\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:471},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:509},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:546},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:585},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:622},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"))\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:659},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\">\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:60},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"<\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:97},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"ipython\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:137},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:180},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"input\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:217},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:258},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"4\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:295},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:332},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"c0960e0e33eb\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:369},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\">:\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:417},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"2\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:458},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\":\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:495},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" RuntimeWarning\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:532},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\":\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:583},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" overflow encountered \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:620},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"in\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:678},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:716},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"  np\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:60},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:97},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:136},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:173},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:210},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:247},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"/\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:284},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" np\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:321},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:360},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"sum\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:397},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:436},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"np\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:473},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:511},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:548},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:587},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:624},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"))\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:661},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\">\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:60},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"<\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:97},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"ipython\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:137},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:180},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"input\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:217},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:258},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"4\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:295},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:332},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"c0960e0e33eb\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:369},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\">:\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:417},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"2\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:458},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\":\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:495},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" RuntimeWarning\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:532},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\":\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:583},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" invalid value encountered \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:620},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"in\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:683},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" divide\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:721},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:6,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"  np\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:60},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:97},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:136},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:173},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:210},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:247},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"/\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:284},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" np\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:321},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:360},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"sum\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:397},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:436},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"np\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:473},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:511},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:548},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:587},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:624},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"))\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:661},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:7,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\">\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:8,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" array\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:8,columnNumber:60},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"([\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:8,columnNumber:102},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:8,columnNumber:140},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"0\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:8,columnNumber:177},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".,\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:8,columnNumber:214},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"  \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:8,columnNumber:252},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"0\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:8,columnNumber:290},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".,\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:8,columnNumber:327},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" nan\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:8,columnNumber:365},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"])\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:8,columnNumber:405},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:8,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:84},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:94,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"This poses a problem. If our numbers are too large, how can we ensure we are able to get the same probability distribution without integer overflow. Well, it turns out since Softmax is a monotonically increasing function, we can do the following and still achieve the same distributions.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:105,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.blockquote,{children:[`\n`,(0,e.jsxDEV)(n.p,{children:[\"For a more complex walkthrough, here's an explanation by \",(0,e.jsxDEV)(n.a,{href:\"https://jaykmody.com/blog/stable-softmax/\",children:\"Jay K Mody\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:107,columnNumber:60},this),\". A detailed walkthrough of softmax numerical instability is out of scope for this article.\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:107,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:107,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,e.jsxDEV)(n.pre,{\"data-language\":\"py\",\"data-theme\":\"default\",children:(0,e.jsxDEV)(n.code,{\"data-language\":\"py\",\"data-theme\":\"default\",children:[(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"x \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:109},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:147},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:184},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"[\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:221},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:258},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"10\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:295},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:333},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:370},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"1\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:407},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:444},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"1000\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:481},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"]\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:521},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:90},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"x \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:58},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" x \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:95},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:134},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" np\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:171},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:210},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"max\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:247},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:286},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:323},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:360},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"np\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:58},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:95},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:134},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:171},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:208},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:245},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"/\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:282},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" np\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:319},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:358},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"sum\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:395},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:434},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"np\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:471},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:509},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:546},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:585},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:622},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"))\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:659},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\">\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" This yields \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:60},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"[\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:109},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"0\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:146},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:183},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"0\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:220},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:257},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"1\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:294},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"]\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:331},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:84},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:109,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"This brings us to a numerically stable implementation of the softmax as seen below.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:117,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,e.jsxDEV)(n.pre,{\"data-language\":\"py\",\"data-theme\":\"default\",children:(0,e.jsxDEV)(n.code,{\"data-language\":\"py\",\"data-theme\":\"default\",children:[(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DD4F7D\",fontWeight:\"bold\"},children:\"def\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:109},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:167},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\",fontWeight:\"bold\"},children:\"softmax\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:204},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:266},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:303},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"):\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:340},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:90},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"    \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# assumes x is a vector\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:60},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"    x \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:62},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" x \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:99},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:138},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" np\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:175},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:214},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"max\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:251},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:290},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:327},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:364},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"    \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DD4F7D\",fontWeight:\"bold\"},children:\"return\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:60},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" np\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:121},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:160},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:197},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:236},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:273},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:310},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:347},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"/\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:384},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" np\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:421},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:460},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"sum\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:497},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:536},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"np\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:573},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:611},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:648},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:687},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:724},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"))\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:761},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:84},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:119,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h3,{id:\"calculating-the-derivative\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#calculating-the-derivative\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this),\"Calculating the Derivative\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:126,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"Now, let's move on to figuring out what the derivative is. Specifically, given an input \",(0,e.jsxDEV)(s,{math:\"x_j\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:128,columnNumber:89},this),\" we want to calculate it's impact on a final softmax output \",(0,e.jsxDEV)(s,{math:\"S_i\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:128,columnNumber:176},this),\" where we have an input size of \",(0,e.jsxDEV)(s,{math:\"n\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:128,columnNumber:235},this),\". Let's start by writing out our equation.\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:128,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"S_i = \\\\frac{e^{x_i}}{\\\\sum_{k=0}^n e^{x_k}}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:130,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"And we want to find\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:132,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"\\\\frac{\\\\delta S_i}{\\\\delta x_j} = \\\\frac{1}{\\\\delta x_j} [ \\\\frac{e^{x_i}}{\\\\sum_{k=0}^n e^{x_k}} ]\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:134,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"Let's first do a quick substituition where \",(0,e.jsxDEV)(s,{math:\"u = e^{x_i}, v = e^{x_j} + \\\\sum_{k=0,k \\\\neq j} e^{x_k}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:136,columnNumber:44},this),\". (Note here that we've simply pulled out our \",(0,e.jsxDEV)(s,{math:\"e^{x_j}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:136,columnNumber:168},this),\" term out of our original summation.) This means we can rewrite our original equation now as\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:136,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"S(x_i) = \\\\frac{u}{v}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:138,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Which allows us to apply the quotient rule that states that\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:140,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"\\\\frac{\\\\delta S(x_i)}{x_j} = \\\\frac{v\\\\frac{\\\\delta u}{\\\\delta x_j} - u\\\\frac{\\\\delta v}{ \\\\delta x_j}}{v^{2}}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:142,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"which we can then rewrite as\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:144,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"\\\\frac{\\\\delta S(x_i)}{x_j} = \\\\frac{(e^{x_j} + \\\\sum_{k=0,k \\\\neq j} e^{x_k}) \\\\frac{1}{\\\\delta x_j} [e^{x_i}] - e^{x_i} \\\\frac{1}{\\\\delta x_j} [e^{x_j} + \\\\sum_{k=0,k \\\\neq j} e^{x_k}] }{(e^{x_j} + \\\\sum_{k=0,k \\\\neq j} e^{x_k})^2}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:146,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Before we walkthrough the answer, note the following\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:148,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.ul,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:[\"we're taking the derivative with respect to \",(0,e.jsxDEV)(s,{math:\"x_j\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:150,columnNumber:47},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:150,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:[\"if \",(0,e.jsxDEV)(s,{math:\"y = e^x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:151,columnNumber:6},this),\", then this means that \",(0,e.jsxDEV)(s,{math:\"\\\\frac{\\\\delta y}{ \\\\delta x} = e^x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:151,columnNumber:60},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:151,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:[\"if \",(0,e.jsxDEV)(s,{math:\"y = e^{x_i}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:152,columnNumber:6},this),\" and we take the derivative with respect to \",(0,e.jsxDEV)(s,{math:\"x_j\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:152,columnNumber:85},this),\", then this means that we can treat \",(0,e.jsxDEV)(s,{math:\"e^{x_i}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:152,columnNumber:148},this),\" as a constant, and \",(0,e.jsxDEV)(s,{math:\"\\\\frac{\\\\delta y}{\\\\delta x_j} = 0\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:152,columnNumber:199},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:152,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:150,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Let's now apply this new form to solve the two cases.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:154,columnNumber:1},this),`\n`,(0,e.jsxDEV)(\"b\",{children:(0,e.jsxDEV)(n.p,{children:[\"Case 1 : \",(0,e.jsxDEV)(s,{math:\"i \\\\neq j\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:157,columnNumber:12},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:157,columnNumber:3},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:156,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"With the points above, we can rewrite our derivative and simplify it as\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:160,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"\\\\begin{equation} \\\\begin{split}  \\\\frac{\\\\delta S(x_i)}{x_j} &= \\\\frac{(e^{x_j} + \\\\sum_{k=0,k \\\\neq j} e^{x_k}) 0 - e^{x_i} (e^{x_j}) }{(\\\\sum_{k=0}^n e^{x_k})^2} \\\\\\\\ &= \\\\frac{-e^{x_i} (e^{x_j})}{(\\\\sum_{k=0}^n e^{x_k})^2} \\\\end{split} \\\\end{equation}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:162,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"If you're confused about why the huge term \",(0,e.jsxDEV)(s,{math:\"e^{x_j} + \\\\sum_{k=0,k \\\\neq j} e^{x_k}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:164,columnNumber:44},this),\" was simplified, consider the fact that there are no terms expressed in terms of \",(0,e.jsxDEV)(s,{math:\"x_j\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:164,columnNumber:186},this),\" in that summation and that \",(0,e.jsxDEV)(s,{math:\"y = e^{x_j}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:164,columnNumber:241},this),\" implies that \",(0,e.jsxDEV)(s,{math:\"\\\\frac{\\\\delta y}{\\\\delta x_j} = e^{x_j}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:164,columnNumber:290},this),\". Now, our derivative looks a little scary but if we rewrite it a little bit, we get the following\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:164,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"\\\\begin{equation} \\\\begin{split} \\\\frac{\\\\delta S(x_i)}{\\\\delta x_j} &= -\\\\frac{e^{x_i}}{\\\\sum_{k=0}^n e^{x_k}} \\\\times \\\\frac{e^{x_j}}{\\\\sum_{k=0}^n e^{x_k}} \\\\\\\\ &= -S(x_i) S(x_j)  \\\\end{split} \\\\end{equation}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:166,columnNumber:1},this),`\n`,(0,e.jsxDEV)(\"b\",{children:(0,e.jsxDEV)(n.p,{children:[\"Case 2 : \",(0,e.jsxDEV)(s,{math:\"i = j\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:169,columnNumber:12},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:169,columnNumber:3},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:168,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"In this case, we can rewrite our equation as\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:172,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"\\\\frac{\\\\delta S(x_i)}{x_i} = \\\\frac{(e^{x_i} + \\\\sum_{k=0,k \\\\neq i}^n e^{x_k}) \\\\frac{1}{\\\\delta x_i} [e^{x_i}] - e^{x_i} \\\\frac{1}{\\\\delta x_i} [e^{x_i} + \\\\sum_{k=0,k \\\\neq j}^n e^{x_k}] }{(e^{x_i} + \\\\sum_{k=0,k \\\\neq i}^n e^{x_k})^2}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:174,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Which is going to be simplified to\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:176,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"\\\\begin{equation} \\\\begin{split} \\\\frac{\\\\delta S(x_i)}{x_i} &= \\\\frac{(e^{x_i} + \\\\sum_{k=0,k \\\\neq i} e^{x_k}) e^{x_i} - e^{x_i} ( e^{x_i} ) }{(\\\\sum_{k=0}^n e^{x_k})^2} \\\\\\\\ &= \\\\frac{e^{x_i} (\\\\sum_{k=0,k \\\\neq i} e^{x_k}) }{(\\\\sum_{k=0}^n e^{x_k})^2} \\\\\\\\ &= \\\\frac{e^{x_i} ((\\\\sum_{k=0}^n e^{x_k}) - e^{x_i}) }{(\\\\sum_{k=0}^n e^{x_k})^2} \\\\\\\\ &= S(x_i) ( 1 - S(x_i))  \\\\end{split} \\\\end{equation}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:178,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"This therefore means that we can express our derivative in these two cases\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:180,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:`\\\\frac{\\\\delta S(x_i)}{x_j} = \\\\begin{cases}\nS(x_i) ( 1 - S(x_i))  & i = j \\\\\\\\\n-S(x_i) S(x_j) & i \\\\neq j\n\\\\end{cases}`},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:182,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h2,{id:\"cross-entropy-loss\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#cross-entropy-loss\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this),\"Cross-Entropy Loss\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:189,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"The Cross Entropy loss is commonly used when we have a model that we want to train to be able to classify an input into a specific class or multiple classes. In this article and example, we'll be looking at the case whereby we're trying to classify an input into a specific class.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:191,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h3,{id:\"loss-functions\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#loss-functions\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this),\"Loss Functions\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:193,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"When we have a loss function, we can take a prediction \",(0,e.jsxDEV)(s,{math:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:195,columnNumber:56},this),\" and compute how good it is w.r.t some ground truth. This means that the better the predictions, \",(0,e.jsxDEV)(\"b\",{children:\"the lower the loss\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:195,columnNumber:178},this),\". Our goal in doing so is to create a single objective number that we can look to slowly minimise.\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:195,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"Conceptually, this is because minimising a loss function means driving it as close to 0. If we tried to create a loss that we could maximise instead, then we simply wouldn't be able to maximise it since it would span from \",(0,e.jsxDEV)(s,{math:\"0,\\\\infty\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:197,columnNumber:223},this),\".\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:197,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"So this brings us to two simple characteristics of a loss function\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:199,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.ul,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:[\"It has to have a range between \",(0,e.jsxDEV)(s,{math:\"0,\\\\infty\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:201,columnNumber:34},this),\". If not we would be minimising towards \",(0,e.jsxDEV)(s,{math:\"-\\\\infty\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:201,columnNumber:106},this),\".\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:201,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:\"The better our predictions, the lower our loss should be\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:202,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:201,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h3,{id:\"softmax-and-the-loss\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#softmax-and-the-loss\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this),\"Softmax and the Loss\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:204,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"We can see that our softmax outputs a vector which contains probabilities. These will range from 0 to 1. In our case, since we are looking to make a correct prediction, ideally our probability for the correct class should be 1. When it's a bad prediction, it will be close to 0.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:206,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"If we took the raw probability as the loss, then this would mean that the better our predictions, the higher our loss. That's where the Cross-Entropy Loss comes in. It has the formula of\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:208,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"L = -\\\\sum_{i=0}^n t_i log(S(X_i))\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:210,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"where \",(0,e.jsxDEV)(s,{math:\"t_i\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:212,columnNumber:7},this),\" represents the predicted label for the i-th class and \",(0,e.jsxDEV)(s,{math:\"y_i\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:212,columnNumber:89},this),\" represents the predicted probability that our softmax produces for the specific class \",(0,e.jsxDEV)(s,{math:\"i\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:212,columnNumber:203},this),\". Since a item either belongs or does not belong to a class, this means that \",(0,e.jsxDEV)(s,{math:\"t_i\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:212,columnNumber:305},this),\" can only take on the values of \",(0,e.jsxDEV)(s,{math:\"0,1\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:212,columnNumber:364},this),\". Since we're predicting for a single class, this also means that essentially have the following sum\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:212,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"L = -(0 \\\\times log(S(X_0)) + 0 \\\\times log(S(X_1)) + \\\\dots + 1 \\\\times log(S(X_i)) )\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:214,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Which brings our loss to\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:216,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"L = -log(S(x_i))\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:218,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"where \",(0,e.jsxDEV)(s,{math:\"i\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:220,columnNumber:7},this),\" represents the index of the correct class. This derivative is simply to calculate and is just\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:220,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:`\n\\\\frac{\\\\delta L}{\\\\delta S(x_i)} = - \\\\frac{1}{S(x_i)} \n`},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:222,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h2,{id:\"bringing-it-all-together\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#bringing-it-all-together\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this),\"Bringing It All Together\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:228,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"We've now found two equations. The first is the cross entropy loss with respect to a specific softmax value.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:230,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:`\n\\\\frac{\\\\delta L}{\\\\delta S(x_i)} = - \\\\frac{1}{S(x_i)} \n`},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:232,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"The second is the softmax value w.r.t its original inputs.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:238,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:`\\\\frac{\\\\delta S(x_i)}{x_j} = \\\\begin{cases}\nS(x_i) ( 1 - S(x_i))  & i = j \\\\\\\\\n-S(x_i) S(x_j) & i \\\\neq j\n\\\\end{cases}`},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:240,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"We can simply apply the chain rule to get the derivative of the loss w.r.t the original inputs to the softmax.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:247,columnNumber:1},this),`\n`,(0,e.jsxDEV)(\"b\",{children:(0,e.jsxDEV)(n.p,{children:[\"Case 1 : \",(0,e.jsxDEV)(s,{math:\"i \\\\neq j\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:250,columnNumber:12},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:250,columnNumber:3},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:249,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"\\\\begin{equation}\\\\begin{split} \\\\frac{\\\\delta L}{\\\\delta x_j} &= \\\\frac{\\\\delta L}{\\\\delta S(x_i)} \\\\times \\\\frac{\\\\delta S(x_i)}{x_j} \\\\\\\\ &= -\\\\frac{1}{S(x_i)} \\\\times -S(x_i) S(x_j) \\\\\\\\ &= S(x_j) \\\\end{split}\\\\end{equation}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:253,columnNumber:1},this),`\n`,(0,e.jsxDEV)(\"b\",{children:(0,e.jsxDEV)(n.p,{children:[\"Case 2 : \",(0,e.jsxDEV)(s,{math:\"i = j\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:256,columnNumber:12},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:256,columnNumber:3},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:255,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:\"\\\\begin{equation}\\\\begin{split} \\\\frac{\\\\delta L}{\\\\delta x_j} &= \\\\frac{\\\\delta L}{\\\\delta S(x_i)} \\\\times \\\\frac{\\\\delta S(x_i)}{x_j} \\\\\\\\ &= -\\\\frac{1}{S(x_i)} \\\\times S(x_i) ( 1 - S(x_i))  \\\\\\\\ &= S(x_i) - 1 \\\\end{split}\\\\end{equation}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:259,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"We can write this in a case form as\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:261,columnNumber:1},this),`\n`,(0,e.jsxDEV)(l,{math:`\\\\frac{\\\\delta L}{\\\\delta x_j} = \\\\begin{cases}\nS(x_i)-1  & i = j \\\\\\\\\nS(x_j) & i \\\\neq j\n\\\\end{cases}`},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:263,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"This makes the derivative back propogation facile to implement in python as an if-else\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:270,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,e.jsxDEV)(n.pre,{\"data-language\":\"py\",\"data-theme\":\"default\",children:(0,e.jsxDEV)(n.code,{\"data-language\":\"py\",\"data-theme\":\"default\",children:[(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DD4F7D\",fontWeight:\"bold\"},children:\"for\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:109},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" j \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:167},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DD4F7D\",fontWeight:\"bold\"},children:\"in\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:206},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:263},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"range\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:300},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:341},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"len\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:378},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:417},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"inputs\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:454},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")):\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:496},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:90},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"  \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DD4F7D\",fontWeight:\"bold\"},children:\"if\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:58},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" j \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:115},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"==\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:154},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" y\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:192},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"[\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:230},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"i\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:267},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"]:\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:304},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"      dW\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"[:,\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:64},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"j\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:103},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"]\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:140},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:177},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:214},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:252},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:289},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:326},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"1\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:363},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:400},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:437},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" softmax_output\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:474},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:525},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:3,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"  \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DD4F7D\",fontWeight:\"bold\"},children:\"else\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:58},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\":\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:117},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:4,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"      dW\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"[:,\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:64},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"j\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:103},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"]\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:140},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:177},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:214},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" softmax_output\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:252},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:5,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:84},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:272,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\",lineNumber:1,columnNumber:1},this)}function xn(u={}){let{wrapper:n}=u.components||{};return n?(0,e.jsxDEV)(n,Object.assign({},u,{children:(0,e.jsxDEV)(we,u,void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this)}),void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx\"},this):we(u)}var yn=xn;function Ae(u,n,l){throw new Error(\"Expected \"+(n?\"component\":\"object\")+\" `\"+u+\"` to be defined: you likely forgot to import, pass, or provide it.\"+(l?\"\\nIt\\u2019s referenced in your code at `\"+l+\"` in `/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-da5e8a10-5927-4ebe-ad56-00a9b401fe3d.mdx`\":\"\"))}return Nn(vn);})();\n/*! Bundled license information:\n\nreact/cjs/react-jsx-dev-runtime.development.js:\n  (**\n   * @license React\n   * react-jsx-dev-runtime.development.js\n   *\n   * Copyright (c) Facebook, Inc. and its affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *)\n*/\n;return Component;"
  },
  "_id": "softmax-cross-entropy.mdx",
  "_raw": {
    "sourceFilePath": "softmax-cross-entropy.mdx",
    "sourceFileName": "softmax-cross-entropy.mdx",
    "sourceFileDir": ".",
    "contentType": "mdx",
    "flattenedPath": "softmax-cross-entropy"
  },
  "type": "Post",
  "url": "/posts/softmax-cross-entropy",
  "slug": "deriving_the_derivative_for_a_softmax_cross_entropy",
  "parsed_date": "Oct 23, 2023",
  "parsed_tags": [
    {
      "name": "CS231n",
      "slug": "cs231n"
    },
    {
      "name": "Mathematics",
      "slug": "mathematics"
    },
    {
      "name": "Machine Learning",
      "slug": "machine_learning"
    }
  ]
}