{
  "title": "A guide to RWKV",
  "date": "2023-09-28T00:00:00.000Z",
  "description": "A guide to a strong open-source transformer alternative",
  "categories": [
    "Machine Learning"
  ],
  "draft": false,
  "body": {
    "raw": "\n## Introduction\n\nRWKV is an alternative to the transformer architecture. It's open source and has it's own [paper](https://arxiv.org/abs/2305.13048) over here. I found out about it sometime back in a paper club and thought i'd write a short article about it with what I had learnt.\n\nHere are some other resources which you might find useful about RWKVs\n\n- [RKWV by Picocreator](https://github.com/PicoCreator/2nd-brain/blob/main/A%20-%20TechTalkCTO/P%20-%20RWKV%20Musings/The%20RWKV%20architecture%20-%20scaling%20RNN%20to%20transformer%20scale/RWKV%20architecture%20-%20Scaling%20an%20RNN%20to%20transformer%20scale.md) This is a markdown file that was used by one of the contributors - Picocreator to give a short presentation on the RWKV architecture.\n\n- [RKWV in 100 lines](https://johanwind.github.io/2023/03/23/rwkv_details.html) Which covers the implementation of RWKV in 100 lines of code. Much of this article is based off the content here - I try to extend and provide my own intuition for some proofs. I've also attached a [colab notebook](https://colab.research.google.com/drive/1ZRHKtJsYY8DSh09Mm2WH7iHayX7NUrMX?usp=sharing) for you if you want to play with the code.\n\nWith that being said, let's dive into RWKVs.\n\n> I'm using the 430M model here. Hence why my embedding space is 1024. Other models might differ so do take note if you are experimenting with the larger models.\n>\n> Do note that there are some issues with numerical instability in the simplified version provided by johanwind which have been fixed in the implementation in Blink's repo. **This is not production code**.\n\n## Background\n\n### Transformers\n\n> For a better and more thorough explanation, do check out [GPT in 60 Lines of\n> numpy](https://jaykmody.com/blog/gpt-from-scratch/) by Jay K mody. Some of the\n> content here is paraphrased and I suggest going to the source for the best\n> understanding.\n\nWhat is a transformer? Normally today, when we talk about transformers, we're refering to GPTs - Generative Pre-Trained Transformers. These are huge models that have billions of parameters and are trained on lots of data. This enables them to be able to have an underlying understanding of language.\n\nHow do they do this? You can think of a transformer as having the following function signature where\n\n- `n_seq`: This is the size of the initial data passed in. It has to be less than or equal to the context length.\n- `n_vocab`: Our transformer outputs a prob distribution for each character in the input + the new predicted output.\n\n```py\ndef gpt(inputs: list[int]) -> list[list[float]]: # inputs has shape [n_seq]\n# output has shape [n_seq, n_vocab]\n\toutput = # beep boop neural network magic\n\treturn output\n```\n\nA big part of this magic happens because of the self-attention mechanism, which gives transformers their special powers but also increases the time needed to make a prediction.\n\n### Attention and Why it sucks\n\n> Some parts of this explanation are from Code Emporium's Excellent explanation\n> on Transformers which you can view\n> [here](https://www.youtube.com/watch?v=TQQlZhbC5ps)\n\nThe most important to take away from this section is that Attention scales quadratically. That's the single biggest bottleneck when we want to scale transformers to do more things.\n\nLet's see a graphical representation of what that might look like\n\n<img src=\"/images/attention_illustration.png\" alt=\"Attention\" />\n\nA few things here to point out\n\n1. Each word never sees a word that's beyond it's position. In the context of GPT when we are doing next token prediction, we don't the model to \"see the future\"\n\n2. Every single word prior to a word is compared against it to determine its relevancy to predicting the next word.\n\nIn our example above,\n\n- What is compared to What (1 comparison )\n- Is is compared to What and Is ( 2 comparisons )\n- My is compared to What,Is and My ( 3 comparisons )\n- Name is compared to What, Is, My and Name ( 4 comparisons )\n\n> In some cases, (1) might not hold (Eg. in Translation) where grammar\n> structures differ between languages but for a GPT, this is normally the case.\n\nbecause (2) is happening, then this means that the number of comparisons for a string that has been broken down into `n` tokens is going to be\n\n<BlockMath math=\"1 + 2 + \\dots + n = \\frac{n(n+1)}{2}\" />\n\nwhich is quadratic in nature. This is an oversimplification of attention but you get the idea. That's why it gets more and more costly as we expand our models context sizes because there are simply more comparisons to be made.\n\n> We cannot cache these previous lookups in a transformer. This is one of the biggest problems with Transformers that **RWKV doesn't have** as you'll see down below.\n\nIn transformers, the self-attention mechanism computes query, key, and value vectors for each word in the input sequence and uses the dot product of these vectors to determine the attention scores. This process is sensitive to the specific tokens in the input sequence, and as a result, caching the attention scores for one sequence may not be applicable to a subsequent sequence.\n\n## RWKV\n\nRWKVs aim to solve the issue of attention by approximating attention with a linear operation instead. This results in 1-1.5x cheaper training costs and around 10x cheaper inference costs, especially as the number of tokens passed into the model increase over time.\n\nWe can see this with the following graphic from the RWKV paper that shows how the inference cost grows with respect to the token count. This means that as the length of what we pass in increases, we enjoy significantly lower inference time with the RWKV architecture.\n\n<img src=\"/images/Scaling_RWKV.png\" />\n\n### High Level Understanding\n\nRWKVs operate using two main mechanisms\n\n1. A world state : This stores information on information such as previous computations\n2. Temporal mechanism : RWKV uses a decay function to reduce the weightage of past information w.r.t new information.\n\nHowever, as a result of a world state, the RWKV model has a major weakness - it might end up discarding content which is relevant but not explictly requested at the start of the prompt.\n\nAs a result, when we're prompting the RWKV model, we want to use the following syntax\n\n```a\n{{INSTRUCTION}}\n\n{{CONTEXT}}\n\n{{ANSWER}}\n```\n\ninstead of the typical format of\n\n```a\n{{CONTEXT}}\n\n{{INSTRUCTION}}\n\n{{ANSWER}}\n```\n\n## Architecture\n\n### Sigmoid\n\nIntuitively, the sigmoid function is used as a activation function in both the time-mixing and acts as a forget gate in our Time Mixing and Channel Mixing blocks. Since all values are effectively coerced from 0 to 1, A value closer to 0 means the information should be forgotten, while a value closer to 1 means the information should be retained.\n\nThis plays a crucial role in determining the relevance of information from prior steps, allowing the network to selectively retain or discard information based on the current input and previous hidden state\n\n### State\n\nIn essence, we can think of the state as being comprised of the following components\n\n`[layerState,layerState,.... ]`\n\nInside each layerState, we have a total of 4 subarrays\n\n`state = np.zeros((N_LAYER, 4, N_EMBD), dtype=np.float32)`\n\ninside the state, we allocate space for each element as\n\n- 0 : prevX computation\n- 1 : prevNum Computation\n- 2 : prevDen Computation\n- 3 : prevChannelMixing result\n\nThis helps our model to be able to get some concept of time. Note that (3) is mostly used to replace the short-term memory ( since it can only look back a single step )\n\n### Time-Mixing\n\nTime mixing approximates attention and can be likened to the LSTM component of a traditional RNN architecture. This is because it has access to two things\n\n- Previous World State\n- Learned weights to determine how to combine previous computations and new computations.\n\n> Intuitively as time `t` increases, then the vector is dependent on a long history and a summation of an increasing number of terms. This creates a memory which can keep track of information provided in an earlier context.\n\nWe can visualise the entire architecture of the time-mixing block as seen below.\n\n<img src=\"/images/Time_Mixing_Block.png\" alt=\"Time Mixing Block Architecture\" />\n\nLet's look at a function to compute time-mixing\n\n```python\n# Time mix layer with the various params\ndef time_mixing(\n\t\t# Incoming state of the current token\n\t\tx,\n\t\t# Previous token shift state\n\t\tlast_x,\n\t\t# Previous state, split across 2 values to prevent overflows\n\t\tlast_num, last_den,\n\t\t# Various weights, all trainable\n\t\tdecay, bonus, mix_k, mix_v, mix_r, Wk, Wv, Wr, Wout\n\t):\n\n\t# Given the incoming state, and the previous token shift state\n\t# compute R,K,V values. The `x * mix + last * (1-mix)` pattern\n\t# helps the model have trained weights to decide which factors\n\t# it wants to use for the respective process\n    k = Wk @ ( x * mix_k + last_x * (1 - mix_k) )\n    v = Wv @ ( x * mix_v + last_x * (1 - mix_v) )\n\n\t# Since R is used for the final gating of output (similar to attention score)\n\t# you can view this as a lite form of Q @ K\n    r = Wr @ ( x * mix_r + last_x * (1 - mix_r) )\n\n\t# Here we effectively do magic(last_state + k) * v\n\t#\n\t# But in essence, its the \"summation with decay\" of all the past expotents\n\t# divided by another set of expotents for numeric stability\n\t# (aka anti exploding gradients).\n\t#\n\t# Bonus is used to boost the signal for the WKV value\n    wkv = (last_num + exp(bonus + k) * v) / \\\n          (last_den + exp(bonus + k))\n\n\t# We compute the cumulative sum, for the next round, where it\n\t# is stored and forwarded as a state, with a gradual\n\t# decay value on the previous value.\n\t#\n\t# `exp(-exp(decay))` is essentialy a math hack to ensure decay\n\t# is between 0-1, and will gradually fade out past value if desired\n\t#\n\t# `exp(k) / exp(k) * v` is the summation accumulation of the current state\n\t# to be used in the next time mix\n    num = exp(-exp(decay)) * last_num + exp(k) * v\n    den = exp(-exp(decay)) * last_den + exp(k)\n\n\t# sigmoid then acts looseley as both a part of Q in QKV,\n\t# and as a forget gate in LSTM (together with decay)\n\t# for the WKV values\n    rwkv = sigmoid(r) * wkv\n\n\t# And finally that gets normalized into an output, and next state\n    return Wout @ rwkv, (x,num,den)\n```\n\nThis function implements the following equations of\n\n<img src=\"/images/time_mixing_eqn.png\" alt=\"Time Mixing Equations\" />\n\nIn our function, We have the parameters of\n\n- `last_x,last_num, last_den` : These are all stored in a huge `(N_Layers, 4,N_embeddings)` array and simply store the previous computations for each layer.\n\n  - `last_x`: <InlineMath math=\"x_{t-1}\" />\n  - `last_num`:<InlineMath math=\"wkv_{t-1}\" /> numerator\n  - `last_den`:<InlineMath math=\"wkv_{t-1}\" /> denominator\n\n- `decay, bonus, mix_k, mix_v, mix_r, Wk, Wv, Wr, Wout`\n  - `decay` : `w` parameter can be treated as <InlineMath math=\"e^{-\\text{decay}}\" />\n  - `bonus` : This is equivalent to the `u` parameter above\n  - `mix_k`,`mix_r` and `mix_v` are equal to <InlineMath math=\"\\mu_k,\\mu_r,\\mu_t\" />\n  - `Wk,Wv,Wr and wout` are equivalent to `W_k,W_v,W_r` and `W_o` above\n- Note here that <InlineMath math=\"\\sigma\" /> simply represents the sigmoid activation function.\n\nIn the code above, it might be a little bit difficult to visualise the dimensions so\n\n- (1024,1024) : <InlineMath math = \"W_r, W_k, W_v\" />\n- (1024, ): <InlineMath math = \"\\mu_r,x_t,x_{t-1},\\mu_k,\\mu_v\" /> , decay, bonus\n\nThis means that essentially <InlineMath math = \"r_t,k_t\" /> and <InlineMath math = \"v_t\" /> are all going to be of the dimension `(1024,)` and the final output of this function will be of `(1024,)`.\n\n<Callout>\n  What's interesting about this is that information on all previous tokens seen\n  is stored in a 1024 dimensional array. Compare this to transformers that\n  generate a `n_seq x n_embd` array due to the attention mechanism. Is attention\n  truly even needed?\n</Callout>\n\n#### Inductive Proof\n\nI was slightly confused by these 4 lines of code since I couldn't quite understand the leap from last_num to num and den to last_den.\n\n```py\nwkv = (last_num + exp(bonus + k) * v) /      \\\n          (last_den + exp(bonus + k))\nrwkv = sigmoid(r) * wkv\n\nnum = exp(-exp(decay)) * last_num + exp(k) * v\nden = exp(-exp(decay)) * last_den + exp(k)\n```\n\nWhich tries to implement the step of\n\n<BlockMath math=\"wkv_t=\\frac{\\sum_{i=1}^{t-1}e^{-(t-1-i)w+k_i}v_{i} + e^{\\mu+k_t}v_t}{\\sum_{i=1}^{t-1}e^{-(t-1-i)w+k_i} + e^{\\mu+k_t}}\" />\n\nLet's try to build the intuition for this step by step. Let's say we wanted to take the sum of all the elements in the following sum. ( This is present in the numerator ).\n\n<BlockMath math=\"\\sum_{i=1}^{t-1}e^{-(t-1-i)w+k_i}v_{i}\" />\n\nLet's also designate the sum of all the elements defined in the sum as <InlineMath math = \"\\alpha_{t-1}\" /> where we are summing elements from 1 to <InlineMath math=\"t-1\" />. How do we get from <InlineMath math =\"\\alpha_{t-1}\" /> to <InlineMath math =\"\\alpha_{t}\" />?\n\nIf we look at the term <InlineMath math = \"\\alpha_{t-1}\"/>, we can see that the final value of the summation is going to be\n\n<BlockMath math=\"e^{-(t-1-(t-1))w+k_i} = e^{k_{t-i}}\" />\n\nWell, what about the second last value of the summation then? it's going to be\n\n<BlockMath math=\"e^{-(t-1-(t-2))w+k_{t-2}} = e^{-w + k_{t-i}}\" />\n\nThis means that we can therefore link <InlineMath math = \"\\alpha_{t-1}\" /> with <InlineMath math = \"\\alpha_{t}\" /> by doing\n\n<BlockMath math=\"\\sum_{i=1}^{t-1}e^{-(t-1-i)w+k_i}v_{i} = \\sum_{i=1}^{t-2}e^{-(t-1-i)w+k_i}v_{i} + e^{k_{t-1}}\" />\n\nWe can perform a similar substituition to get <InlineMath math = \"\\beta_{t} =\\beta_{t-1}+ e^{k_{t-1}}\" />.\n\n```python\nnum = exp(-exp(decay)) * last_num + exp(k) * v\nden = exp(-exp(decay)) * last_den + exp(k)\n```\n\nWe can then rewrite our equation for <InlineMath math = \"wkv_t\" /> as\n\n<BlockMath math=\"wkv_{t} = \\frac{\\alpha_{t-1} + e^{\\text{bonus} + k_{t}}v_t }{\\beta_{t-1} + e^{\\text{bonus} + k_{t}}}\" />\n\nwhich corresponds to our implementation of\n\n```py\nwkv = (last_num + exp(bonus + k) * v) /      \\\n          (last_den + exp(bonus + k))\n    rwkv = sigmoid(r) * wkv\n```\n\n### Channel Mixing\n\nThe channel mixing is the short term component of the system - it only has access to the previous value and it takes a weighted sum of the previous and current value that it has calculated.\n\n<img src=\"/images/Channel_Mixing.png\" />\n\nIt's significantly easier to understand. **Note that all these parameters are learned parameters with the exception of the <InlineMath math=\"x_{t-1}\" /> values**.\n\nOur channel mixing function is implemented as\n\n```python\ndef channel_mixing(x, last_x, mix_k, mix_r, Wk, Wr, Wv):\n    k = Wk @ ( x * mix_k + last_x * (1 - mix_k) )\n    r = Wr @ ( x * mix_r + last_x * (1 - mix_r) )\n    vk = Wv @ np.maximum(k, 0)**2\n    return sigmoid(r) * vk, x\n```\n\n- It's interesting here to note that\n  - <InlineMath math=\"w_k\" /> has a dimensionality of <InlineMath math=\"[4096,1024]\" />\n  - <InlineMath math=\"w_v\" /> has a dimensionality of <InlineMath math=\"[1024,4096]\" />\n\nThis means that we perform a scaling in the channel_mixing step from an initial dimensionality of 1024 to a dimensionality of 4096. This is very similar to the feed forward network that is used as a transformer.\n\n## Bringing it together\n\nIf we look at the code for RWKV in 100 lines, we notice that the RWKV architecture for the 400M model comprises 24 layers of the same block.\n\nEach block comprises\n\n- 1 initial layer norm ( Constant work since the size of the input is fixed as a (1024,) matrix )\n- 1 time_mixing step\n- 1 layer norm ( Also fixed size input of (1024,) )\n- 1 channel mixing step\n\nAll of the operations that we perform in the time_mixing and channel_mixing step are all going to linearly scale with the size of our context.\n\nThe way I understand it is that since information on all previous token is compressed into a single token value\n\n- Time Mixing requires a constant number of operations per prediction step\n- Channel Mixing also requires a constant number of operations per prediction step\n\nTherefore, for every additional token we want to predict or want to add into our context, we have a constant amount of work to be done for each of these tokens. Therefore, this means that the amount of computational work we need to perform will scale roughly linearly with the amount of tokens we eventually need to predict/proccess.\n",
    "code": "var Component=(()=>{var rn=Object.create;var S=Object.defineProperty;var tn=Object.getOwnPropertyDescriptor;var un=Object.getOwnPropertyNames;var fn=Object.getPrototypeOf,bn=Object.prototype.hasOwnProperty;var B=(r,n)=>()=>(n||r((n={exports:{}}).exports,n),n.exports),_n=(r,n)=>{for(var u in n)S(r,u,{get:n[u],enumerable:!0})},De=(r,n,u,d)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let h of un(n))!bn.call(r,h)&&h!==u&&S(r,h,{get:()=>n[h],enumerable:!(d=tn(n,h))||d.enumerable});return r};var pn=(r,n,u)=>(u=r!=null?rn(fn(r)):{},De(n||!r||!r.__esModule?S(u,\"default\",{value:r,enumerable:!0}):u,r)),Nn=r=>De(S({},\"__esModule\",{value:!0}),r);var Ue=B((En,Ee)=>{Ee.exports=React});var Fe=B(H=>{\"use strict\";(function(){\"use strict\";var r=Ue(),n=Symbol.for(\"react.element\"),u=Symbol.for(\"react.portal\"),d=Symbol.for(\"react.fragment\"),h=Symbol.for(\"react.strict_mode\"),G=Symbol.for(\"react.profiler\"),X=Symbol.for(\"react.provider\"),Q=Symbol.for(\"react.context\"),g=Symbol.for(\"react.forward_ref\"),P=Symbol.for(\"react.suspense\"),O=Symbol.for(\"react.suspense_list\"),C=Symbol.for(\"react.memo\"),I=Symbol.for(\"react.lazy\"),we=Symbol.for(\"react.offscreen\"),J=Symbol.iterator,ke=\"@@iterator\";function Te(a){if(a===null||typeof a!=\"object\")return null;var i=J&&a[J]||a[ke];return typeof i==\"function\"?i:null}var D=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function _(a){{for(var i=arguments.length,s=new Array(i>1?i-1:0),m=1;m<i;m++)s[m-1]=arguments[m];Re(\"error\",a,s)}}function Re(a,i,s){{var m=D.ReactDebugCurrentFrame,c=m.getStackAddendum();c!==\"\"&&(i+=\"%s\",s=s.concat([c]));var t=s.map(function(o){return String(o)});t.unshift(\"Warning: \"+i),Function.prototype.apply.call(console[a],console,t)}}var We=!1,Se=!1,Pe=!1,Oe=!1,Ie=!1,Z;Z=Symbol.for(\"react.module.reference\");function je(a){return!!(typeof a==\"string\"||typeof a==\"function\"||a===d||a===G||Ie||a===h||a===P||a===O||Oe||a===we||We||Se||Pe||typeof a==\"object\"&&a!==null&&(a.$$typeof===I||a.$$typeof===C||a.$$typeof===X||a.$$typeof===Q||a.$$typeof===g||a.$$typeof===Z||a.getModuleId!==void 0))}function Me(a,i,s){var m=a.displayName;if(m)return m;var c=i.displayName||i.name||\"\";return c!==\"\"?s+\"(\"+c+\")\":s}function ee(a){return a.displayName||\"Context\"}function x(a){if(a==null)return null;if(typeof a.tag==\"number\"&&_(\"Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue.\"),typeof a==\"function\")return a.displayName||a.name||null;if(typeof a==\"string\")return a;switch(a){case d:return\"Fragment\";case u:return\"Portal\";case G:return\"Profiler\";case h:return\"StrictMode\";case P:return\"Suspense\";case O:return\"SuspenseList\"}if(typeof a==\"object\")switch(a.$$typeof){case Q:var i=a;return ee(i)+\".Consumer\";case X:var s=a;return ee(s._context)+\".Provider\";case g:return Me(a,a.render,\"ForwardRef\");case C:var m=a.displayName||null;return m!==null?m:x(a.type)||\"Memo\";case I:{var c=a,t=c._payload,o=c._init;try{return x(o(t))}catch{return null}}}return null}var v=Object.assign,F=0,ne,ae,ie,se,me,le,oe;function de(){}de.__reactDisabledLog=!0;function Ve(){{if(F===0){ne=console.log,ae=console.info,ie=console.warn,se=console.error,me=console.group,le=console.groupCollapsed,oe=console.groupEnd;var a={configurable:!0,enumerable:!0,value:de,writable:!0};Object.defineProperties(console,{info:a,log:a,warn:a,error:a,group:a,groupCollapsed:a,groupEnd:a})}F++}}function Le(){{if(F--,F===0){var a={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:v({},a,{value:ne}),info:v({},a,{value:ae}),warn:v({},a,{value:ie}),error:v({},a,{value:se}),group:v({},a,{value:me}),groupCollapsed:v({},a,{value:le}),groupEnd:v({},a,{value:oe})})}F<0&&_(\"disabledDepth fell below zero. This is a bug in React. Please file an issue.\")}}var j=D.ReactCurrentDispatcher,M;function w(a,i,s){{if(M===void 0)try{throw Error()}catch(c){var m=c.stack.trim().match(/\\n( *(at )?)/);M=m&&m[1]||\"\"}return`\n`+M+a}}var V=!1,k;{var qe=typeof WeakMap==\"function\"?WeakMap:Map;k=new qe}function ce(a,i){if(!a||V)return\"\";{var s=k.get(a);if(s!==void 0)return s}var m;V=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var t;t=j.current,j.current=null,Ve();try{if(i){var o=function(){throw Error()};if(Object.defineProperty(o.prototype,\"props\",{set:function(){throw Error()}}),typeof Reflect==\"object\"&&Reflect.construct){try{Reflect.construct(o,[])}catch(y){m=y}Reflect.construct(a,[],o)}else{try{o.call()}catch(y){m=y}a.call(o.prototype)}}else{try{throw Error()}catch(y){m=y}a()}}catch(y){if(y&&m&&typeof y.stack==\"string\"){for(var l=y.stack.split(`\n`),p=m.stack.split(`\n`),f=l.length-1,b=p.length-1;f>=1&&b>=0&&l[f]!==p[b];)b--;for(;f>=1&&b>=0;f--,b--)if(l[f]!==p[b]){if(f!==1||b!==1)do if(f--,b--,b<0||l[f]!==p[b]){var N=`\n`+l[f].replace(\" at new \",\" at \");return a.displayName&&N.includes(\"<anonymous>\")&&(N=N.replace(\"<anonymous>\",a.displayName)),typeof a==\"function\"&&k.set(a,N),N}while(f>=1&&b>=0);break}}}finally{V=!1,j.current=t,Le(),Error.prepareStackTrace=c}var U=a?a.displayName||a.name:\"\",ve=U?w(U):\"\";return typeof a==\"function\"&&k.set(a,ve),ve}function Ke(a,i,s){return ce(a,!1)}function Ye(a){var i=a.prototype;return!!(i&&i.isReactComponent)}function T(a,i,s){if(a==null)return\"\";if(typeof a==\"function\")return ce(a,Ye(a));if(typeof a==\"string\")return w(a);switch(a){case P:return w(\"Suspense\");case O:return w(\"SuspenseList\")}if(typeof a==\"object\")switch(a.$$typeof){case g:return Ke(a.render);case C:return T(a.type,i,s);case I:{var m=a,c=m._payload,t=m._init;try{return T(t(c),i,s)}catch{}}}return\"\"}var R=Object.prototype.hasOwnProperty,re={},te=D.ReactDebugCurrentFrame;function W(a){if(a){var i=a._owner,s=T(a.type,a._source,i?i.type:null);te.setExtraStackFrame(s)}else te.setExtraStackFrame(null)}function $e(a,i,s,m,c){{var t=Function.call.bind(R);for(var o in a)if(t(a,o)){var l=void 0;try{if(typeof a[o]!=\"function\"){var p=Error((m||\"React class\")+\": \"+s+\" type `\"+o+\"` is invalid; it must be a function, usually from the `prop-types` package, but received `\"+typeof a[o]+\"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.\");throw p.name=\"Invariant Violation\",p}l=a[o](i,o,m,s,null,\"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED\")}catch(f){l=f}l&&!(l instanceof Error)&&(W(c),_(\"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).\",m||\"React class\",s,o,typeof l),W(null)),l instanceof Error&&!(l.message in re)&&(re[l.message]=!0,W(c),_(\"Failed %s type: %s\",s,l.message),W(null))}}}var Be=Array.isArray;function L(a){return Be(a)}function He(a){{var i=typeof Symbol==\"function\"&&Symbol.toStringTag,s=i&&a[Symbol.toStringTag]||a.constructor.name||\"Object\";return s}}function ze(a){try{return ue(a),!1}catch{return!0}}function ue(a){return\"\"+a}function fe(a){if(ze(a))return _(\"The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.\",He(a)),ue(a)}var A=D.ReactCurrentOwner,Ge={key:!0,ref:!0,__self:!0,__source:!0},be,_e,q;q={};function Xe(a){if(R.call(a,\"ref\")){var i=Object.getOwnPropertyDescriptor(a,\"ref\").get;if(i&&i.isReactWarning)return!1}return a.ref!==void 0}function Qe(a){if(R.call(a,\"key\")){var i=Object.getOwnPropertyDescriptor(a,\"key\").get;if(i&&i.isReactWarning)return!1}return a.key!==void 0}function Je(a,i){if(typeof a.ref==\"string\"&&A.current&&i&&A.current.stateNode!==i){var s=x(A.current.type);q[s]||(_('Component \"%s\" contains the string ref \"%s\". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',x(A.current.type),a.ref),q[s]=!0)}}function Ze(a,i){{var s=function(){be||(be=!0,_(\"%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",i))};s.isReactWarning=!0,Object.defineProperty(a,\"key\",{get:s,configurable:!0})}}function en(a,i){{var s=function(){_e||(_e=!0,_(\"%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",i))};s.isReactWarning=!0,Object.defineProperty(a,\"ref\",{get:s,configurable:!0})}}var nn=function(a,i,s,m,c,t,o){var l={$$typeof:n,type:a,key:i,ref:s,props:o,_owner:t};return l._store={},Object.defineProperty(l._store,\"validated\",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(l,\"_self\",{configurable:!1,enumerable:!1,writable:!1,value:m}),Object.defineProperty(l,\"_source\",{configurable:!1,enumerable:!1,writable:!1,value:c}),Object.freeze&&(Object.freeze(l.props),Object.freeze(l)),l};function an(a,i,s,m,c){{var t,o={},l=null,p=null;s!==void 0&&(fe(s),l=\"\"+s),Qe(i)&&(fe(i.key),l=\"\"+i.key),Xe(i)&&(p=i.ref,Je(i,c));for(t in i)R.call(i,t)&&!Ge.hasOwnProperty(t)&&(o[t]=i[t]);if(a&&a.defaultProps){var f=a.defaultProps;for(t in f)o[t]===void 0&&(o[t]=f[t])}if(l||p){var b=typeof a==\"function\"?a.displayName||a.name||\"Unknown\":a;l&&Ze(o,b),p&&en(o,b)}return nn(a,l,p,c,m,A.current,o)}}var K=D.ReactCurrentOwner,pe=D.ReactDebugCurrentFrame;function E(a){if(a){var i=a._owner,s=T(a.type,a._source,i?i.type:null);pe.setExtraStackFrame(s)}else pe.setExtraStackFrame(null)}var Y;Y=!1;function $(a){return typeof a==\"object\"&&a!==null&&a.$$typeof===n}function Ne(){{if(K.current){var a=x(K.current.type);if(a)return`\n\nCheck the render method of \\``+a+\"`.\"}return\"\"}}function sn(a){{if(a!==void 0){var i=a.fileName.replace(/^.*[\\\\\\/]/,\"\"),s=a.lineNumber;return`\n\nCheck your code at `+i+\":\"+s+\".\"}return\"\"}}var he={};function mn(a){{var i=Ne();if(!i){var s=typeof a==\"string\"?a:a.displayName||a.name;s&&(i=`\n\nCheck the top-level render call using <`+s+\">.\")}return i}}function xe(a,i){{if(!a._store||a._store.validated||a.key!=null)return;a._store.validated=!0;var s=mn(i);if(he[s])return;he[s]=!0;var m=\"\";a&&a._owner&&a._owner!==K.current&&(m=\" It was passed a child from \"+x(a._owner.type)+\".\"),E(a),_('Each child in a list should have a unique \"key\" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',s,m),E(null)}}function ye(a,i){{if(typeof a!=\"object\")return;if(L(a))for(var s=0;s<a.length;s++){var m=a[s];$(m)&&xe(m,i)}else if($(a))a._store&&(a._store.validated=!0);else if(a){var c=Te(a);if(typeof c==\"function\"&&c!==a.entries)for(var t=c.call(a),o;!(o=t.next()).done;)$(o.value)&&xe(o.value,i)}}}function ln(a){{var i=a.type;if(i==null||typeof i==\"string\")return;var s;if(typeof i==\"function\")s=i.propTypes;else if(typeof i==\"object\"&&(i.$$typeof===g||i.$$typeof===C))s=i.propTypes;else return;if(s){var m=x(i);$e(s,a.props,\"prop\",m,a)}else if(i.PropTypes!==void 0&&!Y){Y=!0;var c=x(i);_(\"Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?\",c||\"Unknown\")}typeof i.getDefaultProps==\"function\"&&!i.getDefaultProps.isReactClassApproved&&_(\"getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.\")}}function on(a){{for(var i=Object.keys(a.props),s=0;s<i.length;s++){var m=i[s];if(m!==\"children\"&&m!==\"key\"){E(a),_(\"Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.\",m),E(null);break}}a.ref!==null&&(E(a),_(\"Invalid attribute `ref` supplied to `React.Fragment`.\"),E(null))}}function dn(a,i,s,m,c,t){{var o=je(a);if(!o){var l=\"\";(a===void 0||typeof a==\"object\"&&a!==null&&Object.keys(a).length===0)&&(l+=\" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.\");var p=sn(c);p?l+=p:l+=Ne();var f;a===null?f=\"null\":L(a)?f=\"array\":a!==void 0&&a.$$typeof===n?(f=\"<\"+(x(a.type)||\"Unknown\")+\" />\",l=\" Did you accidentally export a JSX literal instead of a component?\"):f=typeof a,_(\"React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s\",f,l)}var b=an(a,i,s,c,t);if(b==null)return b;if(o){var N=i.children;if(N!==void 0)if(m)if(L(N)){for(var U=0;U<N.length;U++)ye(N[U],a);Object.freeze&&Object.freeze(N)}else _(\"React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.\");else ye(N,a)}return a===d?on(b):ln(b),b}}var cn=dn;H.Fragment=d,H.jsxDEV=cn})()});var ge=B((Fn,Ae)=>{\"use strict\";Ae.exports=Fe()});var vn={};_n(vn,{default:()=>yn,frontmatter:()=>hn});var e=pn(ge()),hn={title:\"A guide to RWKV\",date:new Date(16958592e5),categories:[\"Machine Learning\"],description:\"A guide to a strong open-source transformer alternative\"};function Ce(r){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",ul:\"ul\",li:\"li\",blockquote:\"blockquote\",strong:\"strong\",h3:\"h3\",code:\"code\",div:\"div\",pre:\"pre\",ol:\"ol\",h4:\"h4\"},r.components),{BlockMath:u,InlineMath:d,Callout:h}=n;return u||z(\"BlockMath\",!0,\"80:1-80:58\"),h||z(\"Callout\",!0,\"248:1-253:11\"),d||z(\"InlineMath\",!0,\"230:15-230:44\"),(0,e.jsxDEV)(e.Fragment,{children:[(0,e.jsxDEV)(n.h2,{id:\"introduction\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#introduction\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this),\"Introduction\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:9,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"RWKV is an alternative to the transformer architecture. It's open source and has it's own \",(0,e.jsxDEV)(n.a,{href:\"https://arxiv.org/abs/2305.13048\",children:\"paper\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:11,columnNumber:91},this),\" over here. I found out about it sometime back in a paper club and thought i'd write a short article about it with what I had learnt.\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:11,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Here are some other resources which you might find useful about RWKVs\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:13,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.ul,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:[`\n`,(0,e.jsxDEV)(n.p,{children:[(0,e.jsxDEV)(n.a,{href:\"https://github.com/PicoCreator/2nd-brain/blob/main/A%20-%20TechTalkCTO/P%20-%20RWKV%20Musings/The%20RWKV%20architecture%20-%20scaling%20RNN%20to%20transformer%20scale/RWKV%20architecture%20-%20Scaling%20an%20RNN%20to%20transformer%20scale.md\",children:\"RKWV by Picocreator\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:15,columnNumber:3},this),\" This is a markdown file that was used by one of the contributors - Picocreator to give a short presentation on the RWKV architecture.\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:15,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:15,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:[`\n`,(0,e.jsxDEV)(n.p,{children:[(0,e.jsxDEV)(n.a,{href:\"https://johanwind.github.io/2023/03/23/rwkv_details.html\",children:\"RKWV in 100 lines\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:3},this),\" Which covers the implementation of RWKV in 100 lines of code. Much of this article is based off the content here - I try to extend and provide my own intuition for some proofs. I've also attached a \",(0,e.jsxDEV)(n.a,{href:\"https://colab.research.google.com/drive/1ZRHKtJsYY8DSh09Mm2WH7iHayX7NUrMX?usp=sharing\",children:\"colab notebook\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:279},this),\" for you if you want to play with the code.\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:15,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"With that being said, let's dive into RWKVs.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:19,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.blockquote,{children:[`\n`,(0,e.jsxDEV)(n.p,{children:\"I'm using the 430M model here. Hence why my embedding space is 1024. Other models might differ so do take note if you are experimenting with the larger models.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:21,columnNumber:3},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"Do note that there are some issues with numerical instability in the simplified version provided by johanwind which have been fixed in the implementation in Blink's repo. \",(0,e.jsxDEV)(n.strong,{children:\"This is not production code\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:23,columnNumber:174},this),\".\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:23,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:21,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h2,{id:\"background\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#background\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this),\"Background\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:25,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h3,{id:\"transformers\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#transformers\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this),\"Transformers\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:27,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.blockquote,{children:[`\n`,(0,e.jsxDEV)(n.p,{children:[\"For a better and more thorough explanation, do check out \",(0,e.jsxDEV)(n.a,{href:\"https://jaykmody.com/blog/gpt-from-scratch/\",children:`GPT in 60 Lines of\nnumpy`},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:29,columnNumber:60},this),` by Jay K mody. Some of the\ncontent here is paraphrased and I suggest going to the source for the best\nunderstanding.`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:29,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:29,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"What is a transformer? Normally today, when we talk about transformers, we're refering to GPTs - Generative Pre-Trained Transformers. These are huge models that have billions of parameters and are trained on lots of data. This enables them to be able to have an underlying understanding of language.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:34,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"How do they do this? You can think of a transformer as having the following function signature where\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:36,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.ul,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:[(0,e.jsxDEV)(n.code,{children:\"n_seq\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:38,columnNumber:3},this),\": This is the size of the initial data passed in. It has to be less than or equal to the context length.\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:38,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:[(0,e.jsxDEV)(n.code,{children:\"n_vocab\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:39,columnNumber:3},this),\": Our transformer outputs a prob distribution for each character in the input + the new predicted output.\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:39,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:38,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,e.jsxDEV)(n.pre,{\"data-language\":\"py\",\"data-theme\":\"default\",children:(0,e.jsxDEV)(n.code,{\"data-language\":\"py\",\"data-theme\":\"default\",children:[(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DD4F7D\",fontWeight:\"bold\"},children:\"def\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:109},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:167},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\",fontWeight:\"bold\"},children:\"gpt\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:204},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:262},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"inputs\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:299},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\":\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:341},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" list\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:378},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"[\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:419},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"int\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:456},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"])\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:495},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:533},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"->\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:570},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" list\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:611},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"[\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:652},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"list\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:689},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"[\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:729},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"float\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:766},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"]]:\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:807},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:846},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# inputs has shape [n_seq]\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:883},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:90},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# output has shape [n_seq, n_vocab]\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\toutput \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:64},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:101},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# beep boop neural network magic\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:138},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DD4F7D\",fontWeight:\"bold\"},children:\"return\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:57},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" output\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:118},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:84},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:41,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"A big part of this magic happens because of the self-attention mechanism, which gives transformers their special powers but also increases the time needed to make a prediction.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:48,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h3,{id:\"attention-and-why-it-sucks\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#attention-and-why-it-sucks\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this),\"Attention and Why it sucks\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:50,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.blockquote,{children:[`\n`,(0,e.jsxDEV)(n.p,{children:[`Some parts of this explanation are from Code Emporium's Excellent explanation\non Transformers which you can view\n`,(0,e.jsxDEV)(n.a,{href:\"https://www.youtube.com/watch?v=TQQlZhbC5ps\",children:\"here\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:54,columnNumber:3},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:52,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:52,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"The most important to take away from this section is that Attention scales quadratically. That's the single biggest bottleneck when we want to scale transformers to do more things.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:56,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Let's see a graphical representation of what that might look like\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:58,columnNumber:1},this),`\n`,(0,e.jsxDEV)(\"img\",{src:\"/images/attention_illustration.png\",alt:\"Attention\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:60,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"A few things here to point out\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:62,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.ol,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:[`\n`,(0,e.jsxDEV)(n.p,{children:`Each word never sees a word that's beyond it's position. In the context of GPT when we are doing next token prediction, we don't the model to \"see the future\"`},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:64,columnNumber:4},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:64,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:[`\n`,(0,e.jsxDEV)(n.p,{children:\"Every single word prior to a word is compared against it to determine its relevancy to predicting the next word.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:66,columnNumber:4},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:66,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:64,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"In our example above,\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:68,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.ul,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:\"What is compared to What (1 comparison )\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:70,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:\"Is is compared to What and Is ( 2 comparisons )\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:71,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:\"My is compared to What,Is and My ( 3 comparisons )\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:72,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:\"Name is compared to What, Is, My and Name ( 4 comparisons )\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:73,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:70,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.blockquote,{children:[`\n`,(0,e.jsxDEV)(n.p,{children:`In some cases, (1) might not hold (Eg. in Translation) where grammar\nstructures differ between languages but for a GPT, this is normally the case.`},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:75,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:75,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"because (2) is happening, then this means that the number of comparisons for a string that has been broken down into \",(0,e.jsxDEV)(n.code,{children:\"n\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:78,columnNumber:118},this),\" tokens is going to be\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:78,columnNumber:1},this),`\n`,(0,e.jsxDEV)(u,{math:\"1 + 2 + \\\\dots + n = \\\\frac{n(n+1)}{2}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:80,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"which is quadratic in nature. This is an oversimplification of attention but you get the idea. That's why it gets more and more costly as we expand our models context sizes because there are simply more comparisons to be made.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:82,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.blockquote,{children:[`\n`,(0,e.jsxDEV)(n.p,{children:[\"We cannot cache these previous lookups in a transformer. This is one of the biggest problems with Transformers that \",(0,e.jsxDEV)(n.strong,{children:\"RWKV doesn't have\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:84,columnNumber:119},this),\" as you'll see down below.\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:84,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:84,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"In transformers, the self-attention mechanism computes query, key, and value vectors for each word in the input sequence and uses the dot product of these vectors to determine the attention scores. This process is sensitive to the specific tokens in the input sequence, and as a result, caching the attention scores for one sequence may not be applicable to a subsequent sequence.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:86,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h2,{id:\"rwkv\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#rwkv\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this),\"RWKV\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:88,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"RWKVs aim to solve the issue of attention by approximating attention with a linear operation instead. This results in 1-1.5x cheaper training costs and around 10x cheaper inference costs, especially as the number of tokens passed into the model increase over time.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:90,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"We can see this with the following graphic from the RWKV paper that shows how the inference cost grows with respect to the token count. This means that as the length of what we pass in increases, we enjoy significantly lower inference time with the RWKV architecture.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:92,columnNumber:1},this),`\n`,(0,e.jsxDEV)(\"img\",{src:\"/images/Scaling_RWKV.png\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:94,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h3,{id:\"high-level-understanding\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#high-level-understanding\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this),\"High Level Understanding\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:96,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"RWKVs operate using two main mechanisms\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:98,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.ol,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:\"A world state : This stores information on information such as previous computations\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:100,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:\"Temporal mechanism : RWKV uses a decay function to reduce the weightage of past information w.r.t new information.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:101,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:100,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"However, as a result of a world state, the RWKV model has a major weakness - it might end up discarding content which is relevant but not explictly requested at the start of the prompt.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:103,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"As a result, when we're prompting the RWKV model, we want to use the following syntax\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:105,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,e.jsxDEV)(n.pre,{\"data-language\":\"a\",\"data-theme\":\"default\",children:(0,e.jsxDEV)(n.code,{\"data-language\":\"a\",\"data-theme\":\"default\",children:[(0,e.jsxDEV)(n.span,{className:\"line\",children:(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"{{INSTRUCTION}}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:109},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:90},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"}},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"{{CONTEXT}}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"}},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"{{ANSWER}}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:84},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:107,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"instead of the typical format of\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:115,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,e.jsxDEV)(n.pre,{\"data-language\":\"a\",\"data-theme\":\"default\",children:(0,e.jsxDEV)(n.code,{\"data-language\":\"a\",\"data-theme\":\"default\",children:[(0,e.jsxDEV)(n.span,{className:\"line\",children:(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"{{CONTEXT}}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:109},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:90},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"}},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"{{INSTRUCTION}}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"}},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"{{ANSWER}}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:84},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:117,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h2,{id:\"architecture\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#architecture\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this),\"Architecture\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:125,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h3,{id:\"sigmoid\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#sigmoid\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this),\"Sigmoid\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:127,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Intuitively, the sigmoid function is used as a activation function in both the time-mixing and acts as a forget gate in our Time Mixing and Channel Mixing blocks. Since all values are effectively coerced from 0 to 1, A value closer to 0 means the information should be forgotten, while a value closer to 1 means the information should be retained.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:129,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"This plays a crucial role in determining the relevance of information from prior steps, allowing the network to selectively retain or discard information based on the current input and previous hidden state\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:131,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h3,{id:\"state\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#state\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this),\"State\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:133,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"In essence, we can think of the state as being comprised of the following components\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:135,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:(0,e.jsxDEV)(n.code,{children:\"[layerState,layerState,.... ]\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:137,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:137,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Inside each layerState, we have a total of 4 subarrays\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:139,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:(0,e.jsxDEV)(n.code,{children:\"state = np.zeros((N_LAYER, 4, N_EMBD), dtype=np.float32)\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:141,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:141,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"inside the state, we allocate space for each element as\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:143,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.ul,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:\"0 : prevX computation\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:145,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:\"1 : prevNum Computation\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:146,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:\"2 : prevDen Computation\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:147,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:\"3 : prevChannelMixing result\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:148,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:145,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"This helps our model to be able to get some concept of time. Note that (3) is mostly used to replace the short-term memory ( since it can only look back a single step )\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:150,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h3,{id:\"time-mixing\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#time-mixing\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this),\"Time-Mixing\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:152,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Time mixing approximates attention and can be likened to the LSTM component of a traditional RNN architecture. This is because it has access to two things\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:154,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.ul,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:\"Previous World State\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:156,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:\"Learned weights to determine how to combine previous computations and new computations.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:157,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:156,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.blockquote,{children:[`\n`,(0,e.jsxDEV)(n.p,{children:[\"Intuitively as time \",(0,e.jsxDEV)(n.code,{children:\"t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:159,columnNumber:23},this),\" increases, then the vector is dependent on a long history and a summation of an increasing number of terms. This creates a memory which can keep track of information provided in an earlier context.\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:159,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:159,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"We can visualise the entire architecture of the time-mixing block as seen below.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:161,columnNumber:1},this),`\n`,(0,e.jsxDEV)(\"img\",{src:\"/images/Time_Mixing_Block.png\",alt:\"Time Mixing Block Architecture\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:163,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Let's look at a function to compute time-mixing\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:165,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,e.jsxDEV)(n.pre,{\"data-language\":\"python\",\"data-theme\":\"default\",children:(0,e.jsxDEV)(n.code,{\"data-language\":\"python\",\"data-theme\":\"default\",children:[(0,e.jsxDEV)(n.span,{className:\"line\",children:(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# Time mix layer with the various params\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:109},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:90},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DD4F7D\",fontWeight:\"bold\"},children:\"def\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:78},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\",fontWeight:\"bold\"},children:\"time_mixing\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:115},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:181},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# Incoming state of the current token\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:58},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\tx\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:59},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# Previous token shift state\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:58},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\tlast_x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:64},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:7,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# Previous state, split across 2 values to prevent overflows\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:7,columnNumber:58},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:7,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\tlast_num\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:8,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:8,columnNumber:66},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" last_den\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:8,columnNumber:103},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:8,columnNumber:148},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:8,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:9,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# Various weights, all trainable\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:9,columnNumber:58},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:9,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\tdecay\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:10,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:10,columnNumber:63},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" bonus\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:10,columnNumber:100},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:10,columnNumber:142},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" mix_k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:10,columnNumber:179},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:10,columnNumber:221},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" mix_v\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:10,columnNumber:258},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:10,columnNumber:300},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" mix_r\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:10,columnNumber:337},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:10,columnNumber:379},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" Wk\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:10,columnNumber:416},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:10,columnNumber:455},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" Wv\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:10,columnNumber:492},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:10,columnNumber:531},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" Wr\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:10,columnNumber:568},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:10,columnNumber:607},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" Wout\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:10,columnNumber:644},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:10,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:11,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"):\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:11,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:11,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:12,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:13,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# Given the incoming state, and the previous token shift state\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:13,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:13,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:14,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# compute R,K,V values. The `x * mix + last * (1-mix)` pattern\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:14,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:14,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:15,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# helps the model have trained weights to decide which factors\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:15,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:15,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:16,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# it wants to use for the respective process\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:16,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:16,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"    k \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:62},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" Wk \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:99},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"@\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:139},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:176},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:213},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" x \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:250},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:289},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" mix_k \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:326},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:369},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" last_x \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:406},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:450},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:487},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:524},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"1\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:561},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:598},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:635},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" mix_k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:672},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:714},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:751},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:788},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:17,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"    v \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:62},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" Wv \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:99},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"@\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:139},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:176},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:213},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" x \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:250},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:289},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" mix_v \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:326},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:369},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" last_x \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:406},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:450},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:487},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:524},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"1\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:561},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:598},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:635},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" mix_v\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:672},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:714},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:751},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:788},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:18,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:19,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:20,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# Since R is used for the final gating of output (similar to attention score)\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:20,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:20,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:21,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# you can view this as a lite form of Q @ K\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:21,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:21,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"    r \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:62},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" Wr \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:99},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"@\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:139},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:176},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:213},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" x \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:250},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:289},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" mix_r \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:326},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:369},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" last_x \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:406},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:450},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:487},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:524},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"1\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:561},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:598},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:635},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" mix_r\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:672},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:714},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:751},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:788},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:22,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:23,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:24,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# Here we effectively do magic(last_state + k) * v\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:24,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:24,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:25,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"#\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:25,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:25,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:26,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:'# But in essence, its the \"summation with decay\" of all the past expotents'},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:26,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:26,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:27,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# divided by another set of expotents for numeric stability\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:27,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:27,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:28,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# (aka anti exploding gradients).\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:28,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:28,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:29,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"#\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:29,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:29,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:30,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# Bonus is used to boost the signal for the WKV value\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:30,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:30,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"    wkv \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:64},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:101},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:138},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"last_num \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:175},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:220},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:257},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:297},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"bonus \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:334},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:376},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:413},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:451},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:488},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:525},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" v\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:562},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:600},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:637},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"/\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:674},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:711},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"\\\\\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:748},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:31,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"          \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:32,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:32,columnNumber:66},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"last_den \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:32,columnNumber:103},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:32,columnNumber:148},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:32,columnNumber:185},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:32,columnNumber:225},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"bonus \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:32,columnNumber:262},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:32,columnNumber:304},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:32,columnNumber:341},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"))\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:32,columnNumber:379},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:32,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:33,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:34,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# We compute the cumulative sum, for the next round, where it\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:34,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:34,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:35,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# is stored and forwarded as a state, with a gradual\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:35,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:35,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:36,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# decay value on the previous value.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:36,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:36,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:37,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"#\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:37,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:37,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:38,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# `exp(-exp(decay))` is essentialy a math hack to ensure decay\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:38,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:38,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:39,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# is between 0-1, and will gradually fade out past value if desired\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:39,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:39,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:40,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"#\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:40,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:40,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:41,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# `exp(k) / exp(k) * v` is the summation accumulation of the current state\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:41,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:41,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:42,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# to be used in the next time mix\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:42,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:42,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"    num \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:64},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:101},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:141},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:178},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:215},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:254},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"decay\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:291},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"))\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:332},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:370},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:407},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" last_num \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:444},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:490},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:527},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:567},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:604},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:641},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:678},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:715},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" v\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:752},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:43,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"    den \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:44,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:44,columnNumber:64},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:44,columnNumber:101},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:44,columnNumber:141},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:44,columnNumber:178},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:44,columnNumber:215},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:44,columnNumber:254},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"decay\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:44,columnNumber:291},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"))\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:44,columnNumber:332},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:44,columnNumber:370},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:44,columnNumber:407},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" last_den \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:44,columnNumber:444},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:44,columnNumber:490},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:44,columnNumber:527},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:44,columnNumber:567},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:44,columnNumber:604},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:44,columnNumber:641},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:44,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:45,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:46,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# sigmoid then acts looseley as both a part of Q in QKV,\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:46,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:46,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:47,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# and as a forget gate in LSTM (together with decay)\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:47,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:47,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:48,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# for the WKV values\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:48,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:48,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"    rwkv \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:49,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:49,columnNumber:65},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" sigmoid\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:49,columnNumber:102},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:49,columnNumber:146},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"r\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:49,columnNumber:183},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:49,columnNumber:220},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:49,columnNumber:257},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:49,columnNumber:294},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" wkv\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:49,columnNumber:331},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:49,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:50,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:51,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#888888\"},children:\"# And finally that gets normalized into an output, and next state\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:51,columnNumber:57},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:51,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"    \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:52,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DD4F7D\",fontWeight:\"bold\"},children:\"return\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:52,columnNumber:60},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" Wout \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:52,columnNumber:121},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"@\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:52,columnNumber:163},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" rwkv\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:52,columnNumber:200},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:52,columnNumber:241},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:52,columnNumber:278},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:52,columnNumber:315},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:52,columnNumber:352},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:52,columnNumber:389},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"num\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:52,columnNumber:426},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:52,columnNumber:465},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"den\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:52,columnNumber:502},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:52,columnNumber:541},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:52,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:84},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:167,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"This function implements the following equations of\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:222,columnNumber:1},this),`\n`,(0,e.jsxDEV)(\"img\",{src:\"/images/time_mixing_eqn.png\",alt:\"Time Mixing Equations\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:224,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"In our function, We have the parameters of\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:226,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.ul,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:[`\n`,(0,e.jsxDEV)(n.p,{children:[(0,e.jsxDEV)(n.code,{children:\"last_x,last_num, last_den\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:228,columnNumber:3},this),\" : These are all stored in a huge \",(0,e.jsxDEV)(n.code,{children:\"(N_Layers, 4,N_embeddings)\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:228,columnNumber:64},this),\" array and simply store the previous computations for each layer.\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:228,columnNumber:3},this),`\n`,(0,e.jsxDEV)(n.ul,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:[(0,e.jsxDEV)(n.code,{children:\"last_x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:230,columnNumber:5},this),\": \",(0,e.jsxDEV)(d,{math:\"x_{t-1}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:230,columnNumber:15},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:230,columnNumber:3},this),`\n`,(0,e.jsxDEV)(n.li,{children:[(0,e.jsxDEV)(n.code,{children:\"last_num\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:231,columnNumber:5},this),\":\",(0,e.jsxDEV)(d,{math:\"wkv_{t-1}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:231,columnNumber:16},this),\" numerator\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:231,columnNumber:3},this),`\n`,(0,e.jsxDEV)(n.li,{children:[(0,e.jsxDEV)(n.code,{children:\"last_den\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:232,columnNumber:5},this),\":\",(0,e.jsxDEV)(d,{math:\"wkv_{t-1}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:232,columnNumber:16},this),\" denominator\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:232,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:230,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:228,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:[`\n`,(0,e.jsxDEV)(n.p,{children:(0,e.jsxDEV)(n.code,{children:\"decay, bonus, mix_k, mix_v, mix_r, Wk, Wv, Wr, Wout\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:234,columnNumber:3},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:234,columnNumber:3},this),`\n`,(0,e.jsxDEV)(n.ul,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:[(0,e.jsxDEV)(n.code,{children:\"decay\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:235,columnNumber:5},this),\" : \",(0,e.jsxDEV)(n.code,{children:\"w\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:235,columnNumber:15},this),\" parameter can be treated as \",(0,e.jsxDEV)(d,{math:\"e^{-\\\\text{decay}}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:235,columnNumber:47},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:235,columnNumber:3},this),`\n`,(0,e.jsxDEV)(n.li,{children:[(0,e.jsxDEV)(n.code,{children:\"bonus\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:236,columnNumber:5},this),\" : This is equivalent to the \",(0,e.jsxDEV)(n.code,{children:\"u\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:236,columnNumber:41},this),\" parameter above\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:236,columnNumber:3},this),`\n`,(0,e.jsxDEV)(n.li,{children:[(0,e.jsxDEV)(n.code,{children:\"mix_k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:237,columnNumber:5},this),\",\",(0,e.jsxDEV)(n.code,{children:\"mix_r\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:237,columnNumber:13},this),\" and \",(0,e.jsxDEV)(n.code,{children:\"mix_v\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:237,columnNumber:25},this),\" are equal to \",(0,e.jsxDEV)(d,{math:\"\\\\mu_k,\\\\mu_r,\\\\mu_t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:237,columnNumber:46},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:237,columnNumber:3},this),`\n`,(0,e.jsxDEV)(n.li,{children:[(0,e.jsxDEV)(n.code,{children:\"Wk,Wv,Wr and wout\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:238,columnNumber:5},this),\" are equivalent to \",(0,e.jsxDEV)(n.code,{children:\"W_k,W_v,W_r\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:238,columnNumber:43},this),\" and \",(0,e.jsxDEV)(n.code,{children:\"W_o\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:238,columnNumber:61},this),\" above\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:238,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:235,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:234,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:[`\n`,(0,e.jsxDEV)(n.p,{children:[\"Note here that \",(0,e.jsxDEV)(d,{math:\"\\\\sigma\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:239,columnNumber:18},this),\" simply represents the sigmoid activation function.\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:239,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:239,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:228,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"In the code above, it might be a little bit difficult to visualise the dimensions so\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:241,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.ul,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:[\"(1024,1024) : \",(0,e.jsxDEV)(d,{math:\"W_r, W_k, W_v\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:243,columnNumber:17},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:243,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:[\"(1024, ): \",(0,e.jsxDEV)(d,{math:\"\\\\mu_r,x_t,x_{t-1},\\\\mu_k,\\\\mu_v\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:244,columnNumber:13},this),\" , decay, bonus\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:244,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:243,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"This means that essentially \",(0,e.jsxDEV)(d,{math:\"r_t,k_t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:246,columnNumber:29},this),\" and \",(0,e.jsxDEV)(d,{math:\"v_t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:246,columnNumber:65},this),\" are all going to be of the dimension \",(0,e.jsxDEV)(n.code,{children:\"(1024,)\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:246,columnNumber:130},this),\" and the final output of this function will be of \",(0,e.jsxDEV)(n.code,{children:\"(1024,)\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:246,columnNumber:189},this),\".\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:246,columnNumber:1},this),`\n`,(0,e.jsxDEV)(h,{children:(0,e.jsxDEV)(n.p,{children:[`What's interesting about this is that information on all previous tokens seen\nis stored in a 1024 dimensional array. Compare this to transformers that\ngenerate a `,(0,e.jsxDEV)(n.code,{children:\"n_seq x n_embd\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:251,columnNumber:14},this),` array due to the attention mechanism. Is attention\ntruly even needed?`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:249,columnNumber:3},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:248,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h4,{id:\"inductive-proof\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#inductive-proof\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this),\"Inductive Proof\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:255,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"I was slightly confused by these 4 lines of code since I couldn't quite understand the leap from last_num to num and den to last_den.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:257,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,e.jsxDEV)(n.pre,{\"data-language\":\"py\",\"data-theme\":\"default\",children:(0,e.jsxDEV)(n.code,{\"data-language\":\"py\",\"data-theme\":\"default\",children:[(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"wkv \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:109},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:149},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:186},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:223},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"last_num \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:260},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:305},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:342},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:382},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"bonus \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:419},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:461},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:498},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:536},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:573},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:610},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" v\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:647},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:685},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:722},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"/\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:759},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"      \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:796},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"\\\\\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:838},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:90},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"          \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:66},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"last_den \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:103},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:148},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:185},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:225},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"bonus \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:262},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:304},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:341},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"))\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:379},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"rwkv \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:61},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" sigmoid\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:98},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:142},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"r\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:179},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:216},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:253},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:290},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" wkv\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:327},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"num \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:60},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:97},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:137},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:174},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:211},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:250},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"decay\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:287},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"))\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:328},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:366},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:403},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" last_num \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:440},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:486},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:523},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:563},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:600},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:637},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:674},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:711},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" v\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:748},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"den \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:60},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:97},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:137},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:174},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:211},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:250},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"decay\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:287},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"))\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:328},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:366},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:403},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" last_den \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:440},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:486},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:523},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:563},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:600},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:637},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:6,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:84},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:259,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Which tries to implement the step of\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:268,columnNumber:1},this),`\n`,(0,e.jsxDEV)(u,{math:\"wkv_t=\\\\frac{\\\\sum_{i=1}^{t-1}e^{-(t-1-i)w+k_i}v_{i} + e^{\\\\mu+k_t}v_t}{\\\\sum_{i=1}^{t-1}e^{-(t-1-i)w+k_i} + e^{\\\\mu+k_t}}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:270,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Let's try to build the intuition for this step by step. Let's say we wanted to take the sum of all the elements in the following sum. ( This is present in the numerator ).\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:272,columnNumber:1},this),`\n`,(0,e.jsxDEV)(u,{math:\"\\\\sum_{i=1}^{t-1}e^{-(t-1-i)w+k_i}v_{i}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:274,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"Let's also designate the sum of all the elements defined in the sum as \",(0,e.jsxDEV)(d,{math:\"\\\\alpha_{t-1}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:276,columnNumber:72},this),\" where we are summing elements from 1 to \",(0,e.jsxDEV)(d,{math:\"t-1\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:276,columnNumber:149},this),\". How do we get from \",(0,e.jsxDEV)(d,{math:\"\\\\alpha_{t-1}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:276,columnNumber:195},this),\" to \",(0,e.jsxDEV)(d,{math:\"\\\\alpha_{t}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:276,columnNumber:234},this),\"?\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:276,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"If we look at the term \",(0,e.jsxDEV)(d,{math:\"\\\\alpha_{t-1}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:278,columnNumber:24},this),\", we can see that the final value of the summation is going to be\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:278,columnNumber:1},this),`\n`,(0,e.jsxDEV)(u,{math:\"e^{-(t-1-(t-1))w+k_i} = e^{k_{t-i}}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:280,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Well, what about the second last value of the summation then? it's going to be\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:282,columnNumber:1},this),`\n`,(0,e.jsxDEV)(u,{math:\"e^{-(t-1-(t-2))w+k_{t-2}} = e^{-w + k_{t-i}}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:284,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"This means that we can therefore link \",(0,e.jsxDEV)(d,{math:\"\\\\alpha_{t-1}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:286,columnNumber:39},this),\" with \",(0,e.jsxDEV)(d,{math:\"\\\\alpha_{t}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:286,columnNumber:81},this),\" by doing\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:286,columnNumber:1},this),`\n`,(0,e.jsxDEV)(u,{math:\"\\\\sum_{i=1}^{t-1}e^{-(t-1-i)w+k_i}v_{i} = \\\\sum_{i=1}^{t-2}e^{-(t-1-i)w+k_i}v_{i} + e^{k_{t-1}}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:288,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"We can perform a similar substituition to get \",(0,e.jsxDEV)(d,{math:\"\\\\beta_{t} =\\\\beta_{t-1}+ e^{k_{t-1}}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:290,columnNumber:47},this),\".\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:290,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,e.jsxDEV)(n.pre,{\"data-language\":\"python\",\"data-theme\":\"default\",children:(0,e.jsxDEV)(n.code,{\"data-language\":\"python\",\"data-theme\":\"default\",children:[(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"num \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:109},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:149},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:186},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:226},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:263},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:300},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:339},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"decay\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:376},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"))\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:417},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:455},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:492},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" last_num \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:529},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:575},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:612},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:652},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:689},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:726},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:763},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:800},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" v\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:837},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:90},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"den \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:60},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:97},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:137},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:174},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:211},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:250},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"decay\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:287},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"))\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:328},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:366},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:403},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" last_den \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:440},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:486},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:523},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:563},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:600},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:637},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:84},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:292,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"We can then rewrite our equation for \",(0,e.jsxDEV)(d,{math:\"wkv_t\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:297,columnNumber:38},this),\" as\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:297,columnNumber:1},this),`\n`,(0,e.jsxDEV)(u,{math:\"wkv_{t} = \\\\frac{\\\\alpha_{t-1} + e^{\\\\text{bonus} + k_{t}}v_t }{\\\\beta_{t-1} + e^{\\\\text{bonus} + k_{t}}}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:299,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"which corresponds to our implementation of\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:301,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,e.jsxDEV)(n.pre,{\"data-language\":\"py\",\"data-theme\":\"default\",children:(0,e.jsxDEV)(n.code,{\"data-language\":\"py\",\"data-theme\":\"default\",children:[(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"wkv \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:109},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:149},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:186},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:223},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"last_num \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:260},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:305},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:342},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:382},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"bonus \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:419},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:461},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:498},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:536},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:573},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:610},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" v\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:647},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:685},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:722},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"/\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:759},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"      \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:796},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"\\\\\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:838},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:90},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"          \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:66},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"last_den \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:103},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:148},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" exp\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:185},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:225},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"bonus \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:262},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:304},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:341},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"))\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:379},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"    rwkv \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:65},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" sigmoid\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:102},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:146},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"r\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:183},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:220},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:257},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:294},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" wkv\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:331},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:84},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:303,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h3,{id:\"channel-mixing\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#channel-mixing\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this),\"Channel Mixing\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:309,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"The channel mixing is the short term component of the system - it only has access to the previous value and it takes a weighted sum of the previous and current value that it has calculated.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:311,columnNumber:1},this),`\n`,(0,e.jsxDEV)(\"img\",{src:\"/images/Channel_Mixing.png\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:313,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:[\"It's significantly easier to understand. \",(0,e.jsxDEV)(n.strong,{children:[\"Note that all these parameters are learned parameters with the exception of the \",(0,e.jsxDEV)(d,{math:\"x_{t-1}\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:315,columnNumber:124},this),\" values\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:315,columnNumber:42},this),\".\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:315,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Our channel mixing function is implemented as\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:317,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,e.jsxDEV)(n.pre,{\"data-language\":\"python\",\"data-theme\":\"default\",children:(0,e.jsxDEV)(n.code,{\"data-language\":\"python\",\"data-theme\":\"default\",children:[(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DD4F7D\",fontWeight:\"bold\"},children:\"def\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:109},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:167},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\",fontWeight:\"bold\"},children:\"channel_mixing\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:204},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:273},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:310},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:347},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" last_x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:384},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:427},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" mix_k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:464},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:506},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" mix_r\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:543},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:585},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" Wk\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:622},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:661},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" Wr\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:698},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:737},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" Wv\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:774},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"):\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:813},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:90},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"    k \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:62},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" Wk \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:99},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"@\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:139},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:176},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:213},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" x \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:250},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:289},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" mix_k \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:326},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:369},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" last_x \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:406},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:450},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:487},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:524},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"1\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:561},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:598},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:635},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" mix_k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:672},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:714},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:751},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:788},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"    r \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:62},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" Wr \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:99},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"@\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:139},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:176},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:213},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" x \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:250},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:289},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" mix_r \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:326},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"+\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:369},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" last_x \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:406},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:450},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:487},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:524},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"1\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:561},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:598},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"-\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:635},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" mix_r\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:672},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:714},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:751},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:788},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:3,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"    vk \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"=\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:63},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" Wv \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:100},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"@\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:140},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" np\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:177},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\".\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:216},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"maximum\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:253},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:296},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:333},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:370},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:407},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"0\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:444},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:481},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"**\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:518},this),(0,e.jsxDEV)(n.span,{style:{color:\"#FAC760\"},children:\"2\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:556},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:4,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.span,{className:\"line\",children:[(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"    \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:20},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DD4F7D\",fontWeight:\"bold\"},children:\"return\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:60},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" sigmoid\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:121},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:165},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\"r\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:202},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\")\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:239},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" \"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:276},this),(0,e.jsxDEV)(n.span,{style:{color:\"#43AAF9\"},children:\"*\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:313},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" vk\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:350},this),(0,e.jsxDEV)(n.span,{style:{color:\"#EFEFEF\"},children:\",\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:389},this),(0,e.jsxDEV)(n.span,{style:{color:\"#DCE3EA\"},children:\" x\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:426},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:5,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:84},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:319,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.ul,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:[\"It's interesting here to note that\",`\n`,(0,e.jsxDEV)(n.ul,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:[(0,e.jsxDEV)(d,{math:\"w_k\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:328,columnNumber:5},this),\" has a dimensionality of \",(0,e.jsxDEV)(d,{math:\"[4096,1024]\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:328,columnNumber:55},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:328,columnNumber:3},this),`\n`,(0,e.jsxDEV)(n.li,{children:[(0,e.jsxDEV)(d,{math:\"w_v\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:329,columnNumber:5},this),\" has a dimensionality of \",(0,e.jsxDEV)(d,{math:\"[1024,4096]\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:329,columnNumber:55},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:329,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:328,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:327,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:327,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"This means that we perform a scaling in the channel_mixing step from an initial dimensionality of 1024 to a dimensionality of 4096. This is very similar to the feed forward network that is used as a transformer.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:331,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.h2,{id:\"bringing-it-together\",children:[(0,e.jsxDEV)(n.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#bringing-it-together\",children:(0,e.jsxDEV)(n.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this)},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this),\"Bringing it together\"]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:333,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"If we look at the code for RWKV in 100 lines, we notice that the RWKV architecture for the 400M model comprises 24 layers of the same block.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:335,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Each block comprises\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:337,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.ul,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:\"1 initial layer norm ( Constant work since the size of the input is fixed as a (1024,) matrix )\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:339,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:\"1 time_mixing step\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:340,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:\"1 layer norm ( Also fixed size input of (1024,) )\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:341,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:\"1 channel mixing step\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:342,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:339,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"All of the operations that we perform in the time_mixing and channel_mixing step are all going to linearly scale with the size of our context.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:344,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"The way I understand it is that since information on all previous token is compressed into a single token value\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:346,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.ul,{children:[`\n`,(0,e.jsxDEV)(n.li,{children:\"Time Mixing requires a constant number of operations per prediction step\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:348,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.li,{children:\"Channel Mixing also requires a constant number of operations per prediction step\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:349,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:348,columnNumber:1},this),`\n`,(0,e.jsxDEV)(n.p,{children:\"Therefore, for every additional token we want to predict or want to add into our context, we have a constant amount of work to be done for each of these tokens. Therefore, this means that the amount of computational work we need to perform will scale roughly linearly with the amount of tokens we eventually need to predict/proccess.\"},void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:351,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\",lineNumber:1,columnNumber:1},this)}function xn(r={}){let{wrapper:n}=r.components||{};return n?(0,e.jsxDEV)(n,Object.assign({},r,{children:(0,e.jsxDEV)(Ce,r,void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this)}),void 0,!1,{fileName:\"/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx\"},this):Ce(r)}var yn=xn;function z(r,n,u){throw new Error(\"Expected \"+(n?\"component\":\"object\")+\" `\"+r+\"` to be defined: you likely forgot to import, pass, or provide it.\"+(u?\"\\nIt\\u2019s referenced in your code at `\"+u+\"` in `/Users/admin/Documents/ivanleo.com/posts/_mdx_bundler_entry_point-543ccf00-7a7a-4cf1-80a6-50f6de359b7e.mdx`\":\"\"))}return Nn(vn);})();\n/*! Bundled license information:\n\nreact/cjs/react-jsx-dev-runtime.development.js:\n  (**\n   * @license React\n   * react-jsx-dev-runtime.development.js\n   *\n   * Copyright (c) Facebook, Inc. and its affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *)\n*/\n;return Component;"
  },
  "_id": "a-guide-to-rwkv.mdx",
  "_raw": {
    "sourceFilePath": "a-guide-to-rwkv.mdx",
    "sourceFileName": "a-guide-to-rwkv.mdx",
    "sourceFileDir": ".",
    "contentType": "mdx",
    "flattenedPath": "a-guide-to-rwkv"
  },
  "type": "Post",
  "url": "/posts/a-guide-to-rwkv",
  "slug": "a_guide_to_rwkv",
  "parsed_date": "Sep 28, 2023",
  "parsed_tags": [
    {
      "name": "Machine Learning",
      "slug": "machine_learning"
    }
  ]
}